npm warn Unknown project config "puppeteer_skip_download". This will stop working in the next major version of npm.

> vault-logic@1.0.0 test
> vitest run --coverage


[1m[46m RUN [49m[22m [36mv4.0.5 [39m[90mC:/Users/scoot/poll/VaultLogic[39m
      [2mCoverage enabled with [22m[33mv8[39m

[90mstdout[2m | tests/integration/auth-oauth.integration.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/collections.e2e.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¶Ã‰ prevent committing .env to code: https://dotenvx.com/precommit

[90mstdout[2m | tests/unit/engine/templateNode.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  suppress all logs with { quiet: true }

[90mstdout[2m | tests/unit/services/WorkflowTemplateService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  specify custom .env file path with { path: '/custom/path/.env' }

[90mstdout[2m | tests/unit/repositories/WorkflowTemplateRepository.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  suppress all logs with { quiet: true }

[90mstdout[2m | tests/integration/datavault.autonumber.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¶Ã‰ encrypt with Dotenvx: https://dotenvx.com

[90mstdout[2m | tests/unit/services/PdfQueueService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Â¢Ã¡âˆ©â••Ã…  run anywhere with `dotenvx run -- yourcommand`

[90mstdout[2m | tests/integration/api.runs.docx.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¹Ã©âˆ©â••Ã… backup and recover secrets: https://dotenvx.com/ops

[90mstdout[2m | tests/integration/api.runs.graph.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  override existing env vars with { override: true }

[90mstdout[2m | tests/integration/api.expression-validation.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¶Ã‰ encrypt with Dotenvx: https://dotenvx.com

[90mstdout[2m | tests/integration/auth-oauth.integration.test.ts[2m > [22m[2mOAuth2 Integration Tests
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  suppress all logs with { quiet: true }

[90mstdout[2m | tests/unit/repositories/WorkflowTemplateRepository.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/api.workflows.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¦Ã‘ sync secrets across teammates & machines: https://dotenvx.com/ops

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  suppress all logs with { quiet: true }

[90mstdout[2m | tests/unit/services/WorkflowTemplateService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/engine/templateNode.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/PdfQueueService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/api.projects.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  suppress all logs with { quiet: true }

[90mstdout[2m | tests/integration/api.templates-runs.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã´Ã­ add observability to secrets: https://dotenvx.com/ops

[90mstdout[2m | tests/integration/auth-jwt.integration.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  load multiple .env files with { path: ['.env.local', '.env'] }

[90mstdout[2m | tests/integration/collections.e2e.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/datavault.autonumber.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":40,"time":1764791511700,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":40,"time":1764791511706,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":40,"time":1764791511700,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":40,"time":1764791511703,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":40,"time":1764791511703,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":40,"time":1764791511729,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":40,"time":1764791511724,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":40,"time":1764791511777,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":40,"time":1764791511856,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
[90mstdout[2m | tests/integration/datavault.autonumber.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [31mÎ“Â¥Â»[39m tests/integration/datavault.autonumber.test.ts [2m([22m[2m5 tests[22m[2m | [22m[33m5 skipped[39m[2m)[22m[33m 349[2mms[22m[39m
     [2m[90mÎ“Ã¥Ã´[39m[22m should generate basic autonumber without prefix
     [2m[90mÎ“Ã¥Ã´[39m[22m should generate autonumber with prefix
     [2m[90mÎ“Ã¥Ã´[39m[22m should generate autonumber with yearly reset format
     [2m[90mÎ“Ã¥Ã´[39m[22m should be atomic and prevent race conditions
     [2m[90mÎ“Ã¥Ã´[39m[22m should prevent manual updates to autonumber values
[90mstdout[2m | tests/integration/collections.e2e.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [31mÎ“Â¥Â»[39m tests/integration/collections.e2e.test.ts [2m([22m[2m23 tests[22m[2m | [22m[33m23 skipped[39m[2m)[22m[33m 696[2mms[22m[39m
       [2m[90mÎ“Ã¥Ã´[39m[22m should create a collection
       [2m[90mÎ“Ã¥Ã´[39m[22m should list collections
       [2m[90mÎ“Ã¥Ã´[39m[22m should get a collection by ID
       [2m[90mÎ“Ã¥Ã´[39m[22m should update a collection
       [2m[90mÎ“Ã¥Ã´[39m[22m should create text field
       [2m[90mÎ“Ã¥Ã´[39m[22m should create email field
       [2m[90mÎ“Ã¥Ã´[39m[22m should create number field
       [2m[90mÎ“Ã¥Ã´[39m[22m should create select field with options
       [2m[90mÎ“Ã¥Ã´[39m[22m should create boolean field
       [2m[90mÎ“Ã¥Ã´[39m[22m should list all fields
       [2m[90mÎ“Ã¥Ã´[39m[22m should update field
       [2m[90mÎ“Ã¥Ã´[39m[22m should create a record
       [2m[90mÎ“Ã¥Ã´[39m[22m should create multiple records
       [2m[90mÎ“Ã¥Ã´[39m[22m should list records with pagination
       [2m[90mÎ“Ã¥Ã´[39m[22m should get a single record
       [2m[90mÎ“Ã¥Ã´[39m[22m should update a record
       [2m[90mÎ“Ã¥Ã´[39m[22m should find records by filters
       [2m[90mÎ“Ã¥Ã´[39m[22m should delete a record
       [2m[90mÎ“Ã¥Ã´[39m[22m should get collection with stats
       [2m[90mÎ“Ã¥Ã´[39m[22m should list collections with stats
       [2m[90mÎ“Ã¥Ã´[39m[22m should enforce required fields
       [2m[90mÎ“Ã¥Ã´[39m[22m should validate field types
       [2m[90mÎ“Ã¥Ã´[39m[22m should delete collection (cascade fields and records)
[90mstdout[2m | tests/unit/services/DatavaultRowsService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  override existing env vars with { override: true }

[90mstdout[2m | tests/unit/services/DatavaultRowsService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/routes/US-A-001-login.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¦Ã‘ sync secrets across teammates & machines: https://dotenvx.com/ops

{"level":30,"time":1764791514528,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":30,"time":1764791514540,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":30,"time":1764791514540,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":30,"time":1764791514540,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":30,"time":1764791514541,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":30,"time":1764791514540,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":30,"time":1764791514541,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":30,"time":1764791514541,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":30,"time":1764791514542,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":40,"time":1764791514589,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
[90mstdout[2m | tests/unit/services/DatavaultRowsService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/DatavaultRowsService.test.ts [2m([22m[2m8 tests[22m[2m)[22m[33m 1335[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should create row with validated values [33m 365[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should coerce boolean values [33m 645[2mms[22m[39m
{"level":30,"time":1764791516454,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":50,"time":1764791517861,"env":"test","error":{"error":{"code":"INTERNAL_ERROR","message":""}},"msg":"Failed to render template"}
{"level":30,"time":1764791517966,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1764791517966,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791517979,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791517979,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791517979,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791517979,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
[90mstdout[2m | tests/integration/api.expression-validation.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/api.templates-runs.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/api.runs.docx.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/api.projects.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/api.workflows.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791517993,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1764791517993,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1764791517995,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1764791517996,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1764791517994,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1764791517998,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1764791517996,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791518011,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791518011,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791518012,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791518012,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
[90mstdout[2m | tests/integration/api.runs.graph.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791518040,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1764791517994,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791518006,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791518007,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791518007,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791518007,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
{"level":30,"time":1764791517994,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791518008,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791518008,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791518009,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791518009,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
{"level":30,"time":1764791517994,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791518008,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791518009,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791518009,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791518009,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
{"level":30,"time":1764791517996,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791518010,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791518010,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791518011,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791518011,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
{"level":30,"time":1764791517999,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791518013,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791518013,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791518014,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791518014,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
[90mstdout[2m | tests/integration/auth-jwt.integration.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791518084,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
[90mstdout[2m | tests/integration/api.snapshots.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¶Ã‰ encrypt with Dotenvx: https://dotenvx.com

{"level":30,"time":1764791518041,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791518060,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791518060,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791518061,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791518061,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
{"level":30,"time":1764791518085,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791518100,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791518100,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791518100,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791518100,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
{"level":30,"time":1764791518283,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791518284,"env":"test","module":"auth","email":"success@example.com","msg":"Token verified successfully"}
{"level":40,"time":1764791518407,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":30,"time":1764791518453,"env":"test","module":"auth","userId":"google-user-success","msg":"User upserted successfully"}
[90mstdout[2m | tests/integration/routes/US-A-001-login.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791518507,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1764791518529,"env":"test","module":"user-credentials-repository","userId":"rRs42d82JRTwtVsyOpnmv","msg":"User credentials created"}
{"level":30,"time":1764791518534,"env":"test","module":"user-credentials-repository","userId":"DgtiPn_TzjCrWrQokHXd3","msg":"User credentials created"}
{"level":30,"time":1764791518535,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::ffff:127.0.0.1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791518507,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791518518,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791518518,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791518519,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791518519,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
{"level":30,"time":1764791518536,"env":"test","module":"auth","email":"testuser@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791518533,"env":"test","module":"auth-routes","userId":"rRs42d82JRTwtVsyOpnmv","email":"test-workflows-lok1U11-30dOWQottJckC@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791518539,"env":"test","module":"user-credentials-repository","userId":"Zg-qzDWqa_G_m7IGiibI7","msg":"User credentials created"}
{"level":30,"time":1764791518540,"env":"test","module":"user-credentials-repository","userId":"AspaZl3zurt1ZIwBI6sBn","msg":"User credentials created"}
{"level":30,"time":1764791518538,"env":"test","module":"auth-routes","userId":"DgtiPn_TzjCrWrQokHXd3","email":"test-templates-kZyS3XZg8lvaSdiVefoh0@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791518542,"env":"test","module":"auth-routes","userId":"Zg-qzDWqa_G_m7IGiibI7","email":"test-projects-GZ4NFb4gM305e5OvmKTYK@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791518543,"env":"test","module":"auth-routes","userId":"AspaZl3zurt1ZIwBI6sBn","email":"test-expr-sPmBy78r5mXDR1geFPte1@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791518563,"env":"test","module":"user-credentials-repository","userId":"wzhJJAb1K9NnrmdbTnZvD","msg":"User credentials created"}
{"level":30,"time":1764791518564,"env":"test","module":"auth","email":"success@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791518566,"env":"test","module":"user-credentials-repository","userId":"-KDKOlajCyYjpWxOGqZzU","msg":"User credentials created"}
{"level":30,"time":1764791518567,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::ffff:127.0.0.1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791518568,"env":"test","module":"auth","email":"testuser@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791518567,"env":"test","module":"auth-routes","userId":"wzhJJAb1K9NnrmdbTnZvD","email":"test-7s1f1tRGUuOEzqgWPaiEN@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791518570,"env":"test","module":"auth-routes","userId":"-KDKOlajCyYjpWxOGqZzU","email":"test-docx-VDBXsNCa8h3m_GD6NpsiO@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791518584,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791518584,"env":"test","module":"auth","email":"tokenfield@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791518591,"env":"test","module":"auth","userId":"google-user-id","msg":"User upserted successfully"}
{"level":40,"time":1764791518659,"env":"test","module":"rbac-middleware","userId":"rRs42d82JRTwtVsyOpnmv","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
{"level":40,"time":1764791518671,"env":"test","module":"rbac-middleware","userId":"AspaZl3zurt1ZIwBI6sBn","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
{"level":40,"time":1764791518692,"env":"test","module":"rbac-middleware","userId":"-KDKOlajCyYjpWxOGqZzU","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
{"level":30,"time":1764791518706,"env":"test","module":"auth","email":"testuser@example.com","msg":"OAuth2 login successful"}
[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests
[22m[39mLogin Status: [33m200[39m
Login Body: {
  "message": "Authentication successful",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJnb29nbGUtdXNlci1pZCIsImVtYWlsIjoidGVzdHVzZXJAZXhhbXBsZS5jb20iLCJ0ZW5hbnRJZCI6IjdmNmIwMWRlLWM2MTctNDJhMS1iMzlhLWIzZDM1YWQxZWM5NSIsInJvbGUiOiJvd25lciIsImlhdCI6MTc2NDc5MTUxOCwiZXhwIjoxNzY1Mzk2MzE4fQ.kty5MKCpbsFVi8ZmPpcKJF8TujKgcdQINiGxUvhYHeA",
  "user": {
    "id": "google-user-id",
    "email": "testuser@example.com",
    "firstName": "Test",
    "lastName": "User",
    "profileImageUrl": "https://example.com/avatar.jpg",
    "tenantId": "7f6b01de-c617-42a1-b39a-b3d35ad1ec95",
    "tenantRole": "owner"
  }
}

{"level":30,"time":1764791518721,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::ffff:127.0.0.1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791518722,"env":"test","module":"auth","email":"other@example.com","msg":"Token verified successfully"}
{"level":40,"time":1764791518722,"env":"test","module":"auth-middleware","path":"/","msg":"No valid authentication found"}
{"level":30,"time":1764791518741,"env":"test","module":"auth","userId":"google-user-token-field","msg":"User upserted successfully"}
[90mstdout[2m | tests/integration/api.runs.docx.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":30,"time":1764791518775,"env":"test","module":"auth","userId":"other-user-id","msg":"User upserted successfully"}
[90mstdout[2m | tests/integration/api.expression-validation.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":30,"time":1764791518801,"env":"test","module":"user-credentials-repository","userId":"axYqgMhffwIVYFgy26NDJ","msg":"User credentials created"}
{"level":30,"time":1764791518801,"env":"test","module":"auth-routes","userId":"axYqgMhffwIVYFgy26NDJ","email":"test-L4j2U4Mxm1N3Z2rQc4avH@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791518849,"env":"test","module":"auth","email":"tokenfield@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791518853,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791518854,"env":"test","module":"auth","email":"tokenfield@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791518879,"env":"test","module":"auth","email":"other@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791518907,"env":"test","module":"auth","userId":"google-user-id","msg":"User upserted successfully"}
{"level":30,"time":1764791518942,"env":"test","module":"user-credentials-repository","userId":"2KzpW5az_J5K8DNJjcGsu","msg":"User credentials created"}
{"level":30,"time":1764791518942,"env":"test","module":"auth-routes","userId":"2KzpW5az_J5K8DNJjcGsu","email":"viewer-ZeqFyXcsbjQVKlqOygQZA@example.com","msg":"User registered successfully"}
 [31mÎ“Â¥Â»[39m tests/integration/api.runs.docx.test.ts [2m([22m[2m6 tests[22m[2m | [22m[33m6 skipped[39m[2m)[22m[33m 770[2mms[22m[39m
       [2m[90mÎ“Ã¥Ã´[39m[22m should execute workflow with template node and generate DOCX
       [2m[90mÎ“Ã¥Ã´[39m[22m should handle missing template data gracefully
       [2m[90mÎ“Ã¥Ã´[39m[22m should download DOCX output from successful run
       [2m[90mÎ“Ã¥Ã´[39m[22m should return 404 for PDF when not generated
       [2m[90mÎ“Ã¥Ã´[39m[22m should return 404 for non-existent run
       [2m[90mÎ“Ã¥Ã´[39m[22m should extract placeholders from uploaded template
 [31mÎ“Â¥Â»[39m tests/integration/api.expression-validation.test.ts [2m([22m[2m13 tests[22m[2m | [22m[33m13 skipped[39m[2m)[22m[33m 808[2mms[22m[39m
       [2m[90mÎ“Ã¥Ã´[39m[22m should validate a correct expression
       [2m[90mÎ“Ã¥Ã´[39m[22m should reject expression with unknown variable
       [2m[90mÎ“Ã¥Ã´[39m[22m should validate expression with helper function
       [2m[90mÎ“Ã¥Ã´[39m[22m should reject invalid syntax
       [2m[90mÎ“Ã¥Ã´[39m[22m should reject without authentication
       [2m[90mÎ“Ã¥Ã´[39m[22m should reject missing required fields
       [2m[90mÎ“Ã¥Ã´[39m[22m should return available variables for a node
       [2m[90mÎ“Ã¥Ã´[39m[22m should return empty array for first node
       [2m[90mÎ“Ã¥Ã´[39m[22m should reject without authentication
       [2m[90mÎ“Ã¥Ã´[39m[22m should reject non-existent workflow
       [2m[90mÎ“Ã¥Ã´[39m[22m should return list of helper functions
       [2m[90mÎ“Ã¥Ã´[39m[22m should reject without authentication
       [2m[90mÎ“Ã¥Ã´[39m[22m should validate expressions with variables from multiple upstream nodes
{"level":30,"time":1764791519013,"env":"test","module":"auth","email":"testuser@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791519019,"env":"test","module":"auth","userId":"google-user-token-field","msg":"User upserted successfully"}
{"level":30,"time":1764791519033,"env":"test","module":"auth","hasToken":false,"origin":"http://localhost:5000","ip":"::ffff:127.0.0.1","msg":"OAuth2 login attempt"}
{"level":40,"time":1764791519033,"env":"test","module":"auth","msg":"OAuth2 login failed: No token provided"}
{"level":30,"time":1764791519041,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::ffff:127.0.0.1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791519041,"env":"test","module":"auth","email":"testuser@example.com","msg":"Token verified successfully"}
{"level":40,"time":1764791519056,"env":"test","module":"rbac-middleware","userId":"2KzpW5az_J5K8DNJjcGsu","userRole":"viewer","permission":"workflow:create","path":"/projects/undefined/workflows","msg":"Permission denied"}
{"level":30,"time":1764791519119,"env":"test","module":"user-credentials-repository","userId":"okFljB4dSoBC38ha1zln8","msg":"User credentials created"}
{"level":30,"time":1764791519120,"env":"test","module":"auth-routes","userId":"okFljB4dSoBC38ha1zln8","email":"test-login-sWO9cs22E5H2v938jc4oH@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791519129,"env":"test","module":"auth","email":"tokenfield@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791519135,"env":"test","module":"auth","hasToken":true,"ip":"::1","msg":"OAuth2 login attempt"}
{"level":40,"time":1764791519135,"env":"test","module":"auth","msg":"OAuth2 login failed: Invalid origin"}
{"level":30,"time":1764791519142,"env":"test","module":"auth","hasToken":true,"origin":"https://malicious-site.com","ip":"::1","msg":"OAuth2 login attempt"}
{"level":40,"time":1764791519142,"env":"test","module":"auth","origin":"https://malicious-site.com","msg":"OAuth2 login failed: Invalid origin"}
{"level":30,"time":1764791519148,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791519148,"env":"test","module":"auth","email":"localhost@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791519188,"env":"test","module":"auth","userId":"google-user-id","msg":"User upserted successfully"}
{"level":30,"time":1764791519282,"env":"test","module":"auth-routes","userId":"okFljB4dSoBC38ha1zln8","email":"test-login-sWO9cs22E5H2v938jc4oH@example.com","msg":"User logged in successfully"}
{"level":30,"time":1764791519305,"env":"test","module":"auth","email":"testuser@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791519312,"env":"test","module":"auth","userId":"google-user-localhost","msg":"User upserted successfully"}
{"level":30,"time":1764791519422,"env":"test","module":"auth","email":"localhost@example.com","msg":"OAuth2 login successful"}
{"level":40,"time":1764791519425,"env":"test","module":"auth-middleware","path":"/api/auth/user","msg":"No valid authentication found"}
{"level":30,"time":1764791519427,"env":"test","module":"auth","hasToken":true,"origin":"http://127.0.0.1:3000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791519427,"env":"test","module":"auth","email":"localhost@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791519432,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::ffff:127.0.0.1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791519433,"env":"test","module":"auth","email":"testuser@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791519442,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
{"level":30,"time":1764791519525,"env":"test","headers":{"host":"localhost:56224","accept-encoding":"gzip, deflate","authorization":"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJEZ3RpUG5fVHpqQ3JXclFva0hYZDMiLCJlbWFpbCI6InRlc3QtdGVtcGxhdGVzLWtaeVMzWFpnOGx2YVNkaVZlZm9oMEBleGFtcGxlLmNvbSIsInRlbmFudElkIjpudWxsLCJyb2xlIjpudWxsLCJpYXQiOjE3NjQ3OTE1MTgsImV4cCI6MTc2NTM5NjMxOH0.RWH10-zCtYfu0iJ8Ez9oNRbuWJlnnBphfDw-tu4bgNw","content-type":"multipart/form-data; boundary=--------------------------5ce692585fb8e4dec60dc9dc","content-length":"388","connection":"close"},"multerInstanceType":"function","multerKeys":["diskStorage","memoryStorage","MulterError"],"hasMemoryStorage":true,"file":{"fieldname":"file","originalname":"test.docx","encoding":"7bit","mimetype":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","buffer":{"type":"Buffer","data":[80,75,3,4]},"size":4},"body":{"name":"Test Template"},"msg":"Debug Template Upload"}
{"level":30,"time":1764791519586,"env":"test","module":"auth","userId":"google-user-id","msg":"User upserted successfully"}
{"level":30,"time":1764791519588,"env":"test","module":"auth","userId":"google-user-localhost","msg":"User upserted successfully"}
{"level":30,"time":1764791519696,"env":"test","module":"auth","email":"testuser@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791519697,"env":"test","module":"auth","email":"localhost@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791519702,"env":"test","module":"auth","hasToken":true,"origin":"http://0.0.0.0:8080","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791519703,"env":"test","module":"auth","email":"localhost@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791519703,"env":"test","module":"auth","email":"testuser@example.com","msg":"User logged out"}
{"level":40,"time":1764791519710,"env":"test","module":"auth-middleware","path":"/api/auth/user","msg":"No valid authentication found"}
{"level":30,"time":1764791519717,"env":"test","module":"auth","msg":"User logged out"}
[90mstdout[2m | tests/integration/routes/US-A-001-login.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":30,"time":1764791519721,"env":"test","headers":{"host":"localhost:56224","accept-encoding":"gzip, deflate","authorization":"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJEZ3RpUG5fVHpqQ3JXclFva0hYZDMiLCJlbWFpbCI6InRlc3QtdGVtcGxhdGVzLWtaeVMzWFpnOGx2YVNkaVZlZm9oMEBleGFtcGxlLmNvbSIsInRlbmFudElkIjpudWxsLCJyb2xlIjpudWxsLCJpYXQiOjE3NjQ3OTE1MTgsImV4cCI6MTc2NTM5NjMxOH0.RWH10-zCtYfu0iJ8Ez9oNRbuWJlnnBphfDw-tu4bgNw","content-type":"multipart/form-data; boundary=--------------------------eaa71d36e4b3d966c4b6b9d4","content-length":"172","connection":"close"},"multerInstanceType":"function","multerKeys":["diskStorage","memoryStorage","MulterError"],"hasMemoryStorage":true,"body":{"name":"Test Template"},"msg":"Debug Template Upload"}
{"level":30,"time":1764791519727,"env":"test","module":"user-credentials-repository","userId":"wY0LWk0xh3IO9Deo3sNVN","msg":"User credentials created"}
{"level":30,"time":1764791519727,"env":"test","module":"auth-routes","userId":"wY0LWk0xh3IO9Deo3sNVN","email":"test-me-j_anfdW-AGUiT-Cfu1s-P@example.com","msg":"User registered successfully"}
{"level":50,"time":1764791519775,"env":"test","error":{"error":{"code":"VALIDATION_ERROR","message":""}},"body":{"name":"Test Template"},"params":{"projectId":"c55b6316-767c-4b33-82fd-c6fae8d0523e"},"msg":"Error creating template"}
{"level":30,"time":1764791519830,"env":"test","headers":{"host":"localhost:56224","accept-encoding":"gzip, deflate","authorization":"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJEZ3RpUG5fVHpqQ3JXclFva0hYZDMiLCJlbWFpbCI6InRlc3QtdGVtcGxhdGVzLWtaeVMzWFpnOGx2YVNkaVZlZm9oMEBleGFtcGxlLmNvbSIsInRlbmFudElkIjpudWxsLCJyb2xlIjpudWxsLCJpYXQiOjE3NjQ3OTE1MTgsImV4cCI6MTc2NTM5NjMxOH0.RWH10-zCtYfu0iJ8Ez9oNRbuWJlnnBphfDw-tu4bgNw","content-type":"multipart/form-data; boundary=--------------------------364be18c47eb0d26cb44ced3","content-length":"406","connection":"close"},"multerInstanceType":"function","multerKeys":["diskStorage","memoryStorage","MulterError"],"hasMemoryStorage":true,"file":{"fieldname":"file","originalname":"test.docx","encoding":"7bit","mimetype":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","buffer":{"type":"Buffer","data":[80,75,3,4]},"size":4},"body":{"name":"List Test OghT0-CXLbXdzfBg5nNBo"},"msg":"Debug Template Upload"}
{"level":40,"time":1764791519842,"env":"test","module":"auth-middleware","path":"/api/auth/me","msg":"No valid authentication found"}
{"level":40,"time":1764791519848,"env":"test","module":"auth-middleware","path":"/api/auth/me","msg":"No valid authentication found"}
{"level":30,"time":1764791519853,"env":"test","module":"auth","msg":"User logged out"}
{"level":30,"time":1764791519859,"env":"test","module":"auth","userId":"google-user-localhost","msg":"User upserted successfully"}
 [32mÎ“Â£Ã´[39m tests/integration/routes/US-A-001-login.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 1223[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should successfully log in with valid Google ID token [33m 507[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return current user if authenticated [33m 384[2mms[22m[39m
[90mstdout[2m | tests/unit/services/DatavaultReferenceColumns.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  enable debug logging with { debug: true }

{"level":30,"time":1764791519964,"env":"test","module":"auth","email":"localhost@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791519971,"env":"test","module":"auth","hasToken":true,"ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791519971,"env":"test","module":"auth","email":"referer@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791520079,"env":"test","module":"user-credentials-repository","userId":"eCjvNLB19DcUGBXSKtcZf","msg":"User credentials created"}
{"level":30,"time":1764791520079,"env":"test","module":"auth-routes","userId":"eCjvNLB19DcUGBXSKtcZf","email":"owner-kKviO7r5oXNHsIqbJbGkL@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791520131,"env":"test","module":"auth","userId":"google-user-referer","msg":"User upserted successfully"}
{"level":30,"time":1764791520139,"env":"test","headers":{"host":"localhost:56224","accept-encoding":"gzip, deflate","authorization":"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJEZ3RpUG5fVHpqQ3JXclFva0hYZDMiLCJlbWFpbCI6InRlc3QtdGVtcGxhdGVzLWtaeVMzWFpnOGx2YVNkaVZlZm9oMEBleGFtcGxlLmNvbSIsInRlbmFudElkIjpudWxsLCJyb2xlIjpudWxsLCJpYXQiOjE3NjQ3OTE1MTgsImV4cCI6MTc2NTM5NjMxOH0.RWH10-zCtYfu0iJ8Ez9oNRbuWJlnnBphfDw-tu4bgNw","content-type":"multipart/form-data; boundary=--------------------------129f489da696184cd50426e6","content-length":"383","connection":"close"},"multerInstanceType":"function","multerKeys":["diskStorage","memoryStorage","MulterError"],"hasMemoryStorage":true,"file":{"fieldname":"file","originalname":"test.docx","encoding":"7bit","mimetype":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","buffer":{"type":"Buffer","data":[80,75,3,4]},"size":4},"body":{"name":"Get Test"},"msg":"Debug Template Upload"}
[90mstdout[2m | tests/unit/services/DatavaultReferenceColumns.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791520238,"env":"test","module":"auth","email":"referer@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791520242,"env":"test","module":"auth","hasToken":true,"origin":"https://app.example.com","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791520243,"env":"test","module":"auth","email":"allowed@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791520248,"env":"test","module":"tenant-routes","tenantId":"bb39ed36-1a6e-4d1f-ba95-6723ad1242d5","userId":"eCjvNLB19DcUGBXSKtcZf","msg":"Tenant created"}
{"level":40,"time":1764791520322,"env":"test","module":"rbac-middleware","userId":"rRs42d82JRTwtVsyOpnmv","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
{"level":50,"time":1764791520381,"env":"test","error":{"issues":[{"code":"invalid_type","expected":"string","received":"undefined","path":["projectId"],"message":"Required"}],"name":"ZodError"},"workflowId":"78b34b88-47f6-4dfc-9846-ce6cd278dee9","userId":"rRs42d82JRTwtVsyOpnmv","msg":"Error moving workflow"}
[90mstdout[2m | tests/integration/auth.integration.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¹Ã©âˆ©â••Ã… backup and recover secrets: https://dotenvx.com/ops

{"level":30,"time":1764791520406,"env":"test","module":"auth","userId":"google-user-allowed","msg":"User upserted successfully"}
{"level":30,"time":1764791520416,"env":"test","headers":{"host":"localhost:56224","accept-encoding":"gzip, deflate","authorization":"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJEZ3RpUG5fVHpqQ3JXclFva0hYZDMiLCJlbWFpbCI6InRlc3QtdGVtcGxhdGVzLWtaeVMzWFpnOGx2YVNkaVZlZm9oMEBleGFtcGxlLmNvbSIsInRlbmFudElkIjpudWxsLCJyb2xlIjpudWxsLCJpYXQiOjE3NjQ3OTE1MTgsImV4cCI6MTc2NTM5NjMxOH0.RWH10-zCtYfu0iJ8Ez9oNRbuWJlnnBphfDw-tu4bgNw","content-type":"multipart/form-data; boundary=--------------------------87b4d4d478e67db4a123bbb5","content-length":"391","connection":"close"},"multerInstanceType":"function","multerKeys":["diskStorage","memoryStorage","MulterError"],"hasMemoryStorage":true,"file":{"fieldname":"file","originalname":"test.docx","encoding":"7bit","mimetype":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","buffer":{"type":"Buffer","data":[80,75,3,4]},"size":4},"body":{"name":"Placeholder Test"},"msg":"Debug Template Upload"}
[90mstdout[2m | tests/unit/docxRenderer.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791520468,"env":"test","module":"user-credentials-repository","userId":"zDIac06qiddglP4Gl7Ga_","msg":"User credentials created"}
{"level":30,"time":1764791520469,"env":"test","module":"auth-routes","userId":"zDIac06qiddglP4Gl7Ga_","email":"builder-mUioegeDo4G0U1LjqhhYA@example.com","msg":"User registered successfully"}
stderr | tests/unit/docxRenderer.test.ts > DOCX Renderer Service > renderDocx > should render a template with simple data
Deprecated method ".setData", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : Error: 
    at deprecatedMethod (C:\Users\scoot\poll\VaultLogic\node_modules\docxtemplater\js\docxtemplater.js:184:167)
    at Docxtemplater.setData (C:\Users\scoot\poll\VaultLogic\node_modules\docxtemplater\js\docxtemplater.js:694:7)
    at renderDocx (C:/Users/scoot/poll/VaultLogic/server/services/docxRenderer.ts:77:9)
    at C:/Users/scoot/poll/VaultLogic/tests/unit/docxRenderer.test.ts:156:22
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:20

stderr | tests/unit/docxRenderer.test.ts > DOCX Renderer Service > renderDocx > should use formatters in templates
Deprecated method ".setData", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : Error: 
    at deprecatedMethod (C:\Users\scoot\poll\VaultLogic\node_modules\docxtemplater\js\docxtemplater.js:184:167)
    at Docxtemplater.setData (C:\Users\scoot\poll\VaultLogic\node_modules\docxtemplater\js\docxtemplater.js:694:7)
    at renderDocx (C:/Users/scoot/poll/VaultLogic/server/services/docxRenderer.ts:77:9)
    at C:/Users/scoot/poll/VaultLogic/tests/unit/docxRenderer.test.ts:193:22
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:20

{"level":30,"time":1764791520511,"env":"test","module":"auth","email":"allowed@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791520518,"env":"test","module":"auth","hasToken":false,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":40,"time":1764791520518,"env":"test","module":"auth","msg":"OAuth2 login failed: No token provided"}
stderr | tests/unit/docxRenderer.test.ts > DOCX Renderer Service > renderDocx > should handle missing data gracefully
Deprecated method ".setData", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : Error: 
    at deprecatedMethod (C:\Users\scoot\poll\VaultLogic\node_modules\docxtemplater\js\docxtemplater.js:184:167)
    at Docxtemplater.setData (C:\Users\scoot\poll\VaultLogic\node_modules\docxtemplater\js\docxtemplater.js:694:7)
    at renderDocx (C:/Users/scoot/poll/VaultLogic/server/services/docxRenderer.ts:77:9)
    at C:/Users/scoot/poll/VaultLogic/tests/unit/docxRenderer.test.ts:221:22
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:20

{"level":30,"time":1764791520524,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":50,"time":1764791520524,"env":"test","module":"auth","err":{"type":"Error","message":"Token used too late, exp=1234567890","stack":"Error: Token used too late, exp=1234567890\n    at C:/Users/scoot/poll/VaultLogic/tests/integration/auth-oauth.integration.test.ts:310:9\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:157:11\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:26\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1636:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1602:10)\n    at runTest (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1309:12)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runFiles (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1526:3)\n    at startTests (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1559:3)\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:76:64\n    at withEnv (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:57:3)\n    at run (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:72:144)"},"msg":"Google token verification failed"}
{"level":50,"time":1764791520525,"env":"test","module":"auth","err":{"type":"Error","message":"Token used too late, exp=1234567890","stack":"Error: Token used too late, exp=1234567890\n    at C:/Users/scoot/poll/VaultLogic/tests/integration/auth-oauth.integration.test.ts:310:9\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:157:11\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:26\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1636:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1602:10)\n    at runTest (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1309:12)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runFiles (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1526:3)\n    at startTests (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1559:3)\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:76:64\n    at withEnv (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:57:3)\n    at run (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:72:144)"},"errorCode":"token_expired","origin":"http://localhost:5000","msg":"Google authentication failed"}
{"level":30,"time":1764791520526,"env":"test","module":"user-credentials-repository","userId":"6RenuPUuHA0_QUkiKiUvi","msg":"User credentials created"}
{"level":30,"time":1764791520526,"env":"test","module":"auth-routes","userId":"6RenuPUuHA0_QUkiKiUvi","email":"other-DDc04zZgN7L05H5o4jZel@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791520531,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":50,"time":1764791520531,"env":"test","module":"auth","err":{"type":"Error","message":"Invalid token signature","stack":"Error: Invalid token signature\n    at C:/Users/scoot/poll/VaultLogic/tests/integration/auth-oauth.integration.test.ts:325:9\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:157:11\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:26\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1636:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1602:10)\n    at runTest (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1309:12)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runFiles (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1526:3)\n    at startTests (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1559:3)\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:76:64\n    at withEnv (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:57:3)\n    at run (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:72:144)"},"msg":"Google token verification failed"}
{"level":50,"time":1764791520531,"env":"test","module":"auth","err":{"type":"Error","message":"Invalid token signature","stack":"Error: Invalid token signature\n    at C:/Users/scoot/poll/VaultLogic/tests/integration/auth-oauth.integration.test.ts:325:9\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:157:11\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:26\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1636:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1602:10)\n    at runTest (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1309:12)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runFiles (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1526:3)\n    at startTests (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1559:3)\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:76:64\n    at withEnv (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:57:3)\n    at run (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:72:144)"},"errorCode":"invalid_token_signature","origin":"http://localhost:5000","msg":"Google authentication failed"}
stderr | tests/unit/docxRenderer.test.ts > DOCX Renderer Service > renderDocx > should use custom output name
Deprecated method ".setData", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : Error: 
    at deprecatedMethod (C:\Users\scoot\poll\VaultLogic\node_modules\docxtemplater\js\docxtemplater.js:184:167)
    at Docxtemplater.setData (C:\Users\scoot\poll\VaultLogic\node_modules\docxtemplater\js\docxtemplater.js:694:7)
    at renderDocx (C:/Users/scoot/poll/VaultLogic/server/services/docxRenderer.ts:77:9)
    at C:/Users/scoot/poll/VaultLogic/tests/unit/docxRenderer.test.ts:246:22
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:20

{"level":30,"time":1764791520536,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":50,"time":1764791520536,"env":"test","module":"auth","err":{"type":"Error","message":"Wrong number of segments in token: abc","stack":"Error: Wrong number of segments in token: abc\n    at C:/Users/scoot/poll/VaultLogic/tests/integration/auth-oauth.integration.test.ts:339:9\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:157:11\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:26\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1636:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1602:10)\n    at runTest (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1309:12)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runFiles (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1526:3)\n    at startTests (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1559:3)\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:76:64\n    at withEnv (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:57:3)\n    at run (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:72:144)"},"msg":"Google token verification failed"}
{"level":50,"time":1764791520537,"env":"test","module":"auth","err":{"type":"Error","message":"Wrong number of segments in token: abc","stack":"Error: Wrong number of segments in token: abc\n    at C:/Users/scoot/poll/VaultLogic/tests/integration/auth-oauth.integration.test.ts:339:9\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:157:11\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:26\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1636:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1602:10)\n    at runTest (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1309:12)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runFiles (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1526:3)\n    at startTests (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1559:3)\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:76:64\n    at withEnv (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:57:3)\n    at run (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:72:144)"},"errorCode":"malformed_token","origin":"http://localhost:5000","msg":"Google authentication failed"}
{"level":30,"time":1764791520542,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":50,"time":1764791520542,"env":"test","module":"auth","err":{"type":"Error","message":"Token audience mismatch","stack":"Error: Token audience mismatch\n    at C:/Users/scoot/poll/VaultLogic/tests/integration/auth-oauth.integration.test.ts:353:9\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:157:11\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:26\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1636:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1602:10)\n    at runTest (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1309:12)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runFiles (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1526:3)\n    at startTests (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1559:3)\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:76:64\n    at withEnv (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:57:3)\n    at run (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:72:144)"},"hint":"Token audience mismatch - check GOOGLE_CLIENT_ID configuration","msg":"Google token verification failed"}
{"level":50,"time":1764791520542,"env":"test","module":"auth","err":{"type":"Error","message":"Token audience mismatch","stack":"Error: Token audience mismatch\n    at C:/Users/scoot/poll/VaultLogic/tests/integration/auth-oauth.integration.test.ts:353:9\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:157:11\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:26\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1636:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1602:10)\n    at runTest (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1309:12)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runFiles (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1526:3)\n    at startTests (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1559:3)\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:76:64\n    at withEnv (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:57:3)\n    at run (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:72:144)"},"errorCode":"audience_mismatch","origin":"http://localhost:5000","msg":"Google authentication failed"}
stderr | tests/unit/docxRenderer.test.ts > DOCX Renderer Service > PDF conversion > should attempt PDF conversion when requested
Deprecated method ".setData", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : Error: 
    at deprecatedMethod (C:\Users\scoot\poll\VaultLogic\node_modules\docxtemplater\js\docxtemplater.js:184:167)
    at Docxtemplater.setData (C:\Users\scoot\poll\VaultLogic\node_modules\docxtemplater\js\docxtemplater.js:694:7)
    at renderDocx (C:/Users/scoot/poll/VaultLogic/server/services/docxRenderer.ts:77:9)
    at C:/Users/scoot/poll/VaultLogic/tests/unit/docxRenderer.test.ts:265:22
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:20

{"level":30,"time":1764791520548,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":40,"time":1764791520548,"env":"test","module":"auth","email":"unverified@example.com","msg":"Email not verified by Google"}
{"level":50,"time":1764791520549,"env":"test","module":"auth","err":{"type":"Error","message":"Email not verified by Google","stack":"Error: Email not verified by Google\n    at verifyGoogleToken (C:/Users/scoot/poll/VaultLogic/server/googleAuth.ts:169:13)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at C:/Users/scoot/poll/VaultLogic/server/googleAuth.ts:296:23"},"msg":"Google token verification failed"}
{"level":50,"time":1764791520549,"env":"test","module":"auth","err":{"type":"Error","message":"Email not verified by Google","stack":"Error: Email not verified by Google\n    at verifyGoogleToken (C:/Users/scoot/poll/VaultLogic/server/googleAuth.ts:169:13)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at C:/Users/scoot/poll/VaultLogic/server/googleAuth.ts:296:23"},"errorCode":"email_not_verified","origin":"http://localhost:5000","msg":"Google authentication failed"}
{"level":30,"time":1764791520555,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":50,"time":1764791520555,"env":"test","module":"auth","err":{"type":"Error","message":"Invalid issuer","stack":"Error: Invalid issuer\n    at C:/Users/scoot/poll/VaultLogic/tests/integration/auth-oauth.integration.test.ts:392:9\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:157:11\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:26\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1636:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1602:10)\n    at runTest (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1309:12)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runFiles (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1526:3)\n    at startTests (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1559:3)\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:76:64\n    at withEnv (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:57:3)\n    at run (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:72:144)"},"hint":"Invalid issuer - token may not be from Google","msg":"Google token verification failed"}
{"level":50,"time":1764791520555,"env":"test","module":"auth","err":{"type":"Error","message":"Invalid issuer","stack":"Error: Invalid issuer\n    at C:/Users/scoot/poll/VaultLogic/tests/integration/auth-oauth.integration.test.ts:392:9\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:157:11\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:753:26\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1636:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1602:10)\n    at runTest (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1309:12)\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runSuite (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1468:8)\n    at runFiles (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1526:3)\n    at startTests (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@vitest/runner/dist/index.js:1559:3)\n    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:76:64\n    at withEnv (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:57:3)\n    at run (file:///C:/Users/scoot/poll/VaultLogic/node_modules/vitest/dist/chunks/base.RFExFinv.js:72:144)"},"errorCode":"invalid_issuer","origin":"http://localhost:5000","msg":"Google authentication failed"}
{"level":30,"time":1764791520560,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791520561,"env":"test","module":"auth","email":"session@example.com","msg":"Token verified successfully"}
{"level":40,"time":1764791520566,"env":"test","error":{},"msg":"libreoffice-convert not available, trying system LibreOffice"}
{"level":40,"time":1764791520596,"env":"test","error":{"code":1,"killed":false,"signal":null,"cmd":"libreoffice --headless --convert-to pdf --outdir \"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs\" \"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs\\simple-template-1764791520542.docx\"","stdout":"","stderr":"'libreoffice' is not recognized as an internal or external command,\r\noperable program or batch file.\r\n"},"msg":"System LibreOffice conversion failed"}
{"level":40,"time":1764791520596,"env":"test","error":{"error":{"code":"INTERNAL_ERROR","message":""}},"msg":"PDF conversion failed"}
[90mstdout[2m | tests/unit/docxRenderer.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/docxRenderer.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 179[2mms[22m[39m
{"level":40,"time":1764791520679,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":30,"time":1764791520682,"env":"test","module":"user-credentials-repository","userId":"tZusZ-KWTZay-iH_gCrzE","msg":"User credentials created"}
{"level":30,"time":1764791520683,"env":"test","module":"auth-routes","userId":"tZusZ-KWTZay-iH_gCrzE","email":"viewer-x_7s24pMma2ruY4N6BUxQ@example.com","msg":"User registered successfully"}
{"level":30,"time":1764791520693,"env":"test","headers":{"host":"localhost:56224","accept-encoding":"gzip, deflate","authorization":"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJEZ3RpUG5fVHpqQ3JXclFva0hYZDMiLCJlbWFpbCI6InRlc3QtdGVtcGxhdGVzLWtaeVMzWFpnOGx2YVNkaVZlZm9oMEBleGFtcGxlLmNvbSIsInRlbmFudElkIjpudWxsLCJyb2xlIjpudWxsLCJpYXQiOjE3NjQ3OTE1MTgsImV4cCI6MTc2NTM5NjMxOH0.RWH10-zCtYfu0iJ8Ez9oNRbuWJlnnBphfDw-tu4bgNw","content-type":"multipart/form-data; boundary=--------------------------f9f8afc33931bab50afbf9b3","content-length":"386","connection":"close"},"multerInstanceType":"function","multerKeys":["diskStorage","memoryStorage","MulterError"],"hasMemoryStorage":true,"file":{"fieldname":"file","originalname":"test.docx","encoding":"7bit","mimetype":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","buffer":{"type":"Buffer","data":[80,75,3,4]},"size":4},"body":{"name":"Update Test"},"msg":"Debug Template Upload"}
{"level":40,"time":1764791520713,"env":"test","module":"rbac-middleware","userId":"rRs42d82JRTwtVsyOpnmv","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
{"level":30,"time":1764791520721,"env":"test","module":"auth","userId":"google-user-session","msg":"User upserted successfully"}
{"level":50,"time":1764791520771,"env":"test","error":{"issues":[{"code":"invalid_type","expected":"string","received":"undefined","path":["projectId"],"message":"Required"}],"name":"ZodError"},"workflowId":"788043b9-5f6a-40ff-9e04-edb0269db65f","userId":"rRs42d82JRTwtVsyOpnmv","msg":"Error moving workflow"}
{"level":30,"time":1764791520824,"env":"test","module":"auth","email":"session@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791520830,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791520831,"env":"test","module":"auth","email":"protected@example.com","msg":"Token verified successfully"}
[90mstdout[2m | tests/unit/services/DatavaultReferenceColumns.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/integration/api.projects.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":40,"time":1764791520917,"env":"test","module":"rbac-middleware","userId":"zDIac06qiddglP4Gl7Ga_","userRole":"builder","requiredRoles":["owner"],"path":"/api/tenants/bb39ed36-1a6e-4d1f-ba95-6723ad1242d5","msg":"Role check failed"}
{"level":40,"time":1764791520922,"env":"test","module":"rbac-middleware","userId":"tZusZ-KWTZay-iH_gCrzE","userRole":"viewer","requiredRoles":["owner"],"path":"/api/tenants/bb39ed36-1a6e-4d1f-ba95-6723ad1242d5","msg":"Role check failed"}
 [32mÎ“Â£Ã´[39m tests/unit/services/DatavaultReferenceColumns.test.ts [2m([22m[2m10 tests[22m[2m)[22m[33m 748[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should validate that reference value is a valid UUID [33m 317[2mms[22m[39m
{"level":30,"time":1764791520990,"env":"test","module":"auth","userId":"google-user-protected","msg":"User upserted successfully"}
{"level":30,"time":1764791521022,"env":"test","headers":{"host":"localhost:56224","accept-encoding":"gzip, deflate","authorization":"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJEZ3RpUG5fVHpqQ3JXclFva0hYZDMiLCJlbWFpbCI6InRlc3QtdGVtcGxhdGVzLWtaeVMzWFpnOGx2YVNkaVZlZm9oMEBleGFtcGxlLmNvbSIsInRlbmFudElkIjpudWxsLCJyb2xlIjpudWxsLCJpYXQiOjE3NjQ3OTE1MTgsImV4cCI6MTc2NTM5NjMxOH0.RWH10-zCtYfu0iJ8Ez9oNRbuWJlnnBphfDw-tu4bgNw","content-type":"multipart/form-data; boundary=--------------------------7a55665f1e621ba4219b9e52","content-length":"386","connection":"close"},"multerInstanceType":"function","multerKeys":["diskStorage","memoryStorage","MulterError"],"hasMemoryStorage":true,"file":{"fieldname":"file","originalname":"test.docx","encoding":"7bit","mimetype":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","buffer":{"type":"Buffer","data":[80,75,3,4]},"size":4},"body":{"name":"Delete Test"},"msg":"Debug Template Upload"}
[90mstdout[2m | tests/integration/api.snapshots.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791521036,"env":"test","module":"tenant-routes","tenantId":"bb39ed36-1a6e-4d1f-ba95-6723ad1242d5","msg":"Tenant updated"}
{"level":30,"time":1764791521037,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
[90mstdout[2m | tests/integration/auth-jwt.integration.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":30,"time":1764791521038,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791521050,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791521050,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791521050,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791521050,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
{"level":30,"time":1764791521094,"env":"test","module":"auth","email":"protected@example.com","msg":"OAuth2 login successful"}
 [32mÎ“Â£Ã´[39m tests/integration/api.projects.test.ts [2m([22m[2m10 tests[22m[2m)[22m[33m 2914[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should soft-delete project [33m 312[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should not allow cross-tenant access [33m 522[2mms[22m[39m
{"level":30,"time":1764791521206,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791521206,"env":"test","module":"auth","email":"multiple@example.com","msg":"Token verified successfully"}
 [32mÎ“Â£Ã´[39m tests/integration/auth-jwt.integration.test.ts [2m([22m[2m17 tests[22m[2m)[22m[33m 2968[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should register a new user with email and password [33m 471[2mms[22m[39m
{"level":50,"time":1764791521344,"env":"test","error":{},"msg":"Error creating DataVault row"}
[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mSelect/Multiselect Columns[2m > [22m[2mshould validate select value against options
[22m[39mRow creation error message: Column 'Status' value must be one of: active, inactive

{"level":30,"time":1764791521366,"env":"test","module":"auth","userId":"google-user-multiple","msg":"User upserted successfully"}
{"level":40,"time":1764791521382,"env":"test","module":"rbac-middleware","userId":"rRs42d82JRTwtVsyOpnmv","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
{"level":30,"time":1764791521469,"env":"test","module":"auth","email":"multiple@example.com","msg":"OAuth2 login successful"}
{"level":50,"time":1764791521547,"env":"test","error":{},"workflowId":"eaf601ba-af50-4022-a392-030fd07f9f95","userId":"rRs42d82JRTwtVsyOpnmv","projectId":"00000000-0000-0000-0000-000000000000","msg":"Error moving workflow"}
[90mstdout[2m | tests/unit/services/DatavaultColumnsService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/DatavaultColumnsService.test.ts[2m > [22m[2mDatavaultColumnsService[2m > [22m[2mgetColumns[2m > [22m[2mshould throw 404 if table not found
[22m[39m[DEBUG] Table not found: 660e8400-e29b-41d4-a716-446655440001

[90mstdout[2m | tests/engine.run-conditions.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Â¢Ã¡âˆ©â••Ã…  run anywhere with `dotenvx run -- yourcommand`

[90mstdout[2m | tests/unit/services/DatavaultColumnsService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/DatavaultColumnsService.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 40[2mms[22m[39m
[90mstdout[2m | tests/unit/ai.service.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791521762,"env":"test","module":"ai-service","duration":3,"sectionsCount":1,"rulesCount":0,"blocksCount":0,"msg":"AI workflow generation succeeded"}
{"level":30,"time":1764791521775,"env":"test","multerImportKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceKeys":["diskStorage","memoryStorage","MulterError"],"multerInstanceType":"function","uploadKeys":["storage","limits","preservePath","fileFilter"],"uploadType":"object","uploadPrototype":{},"msg":"Debug Multer Import"}
[90mstdout[2m | tests/unit/ai.service.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":50,"time":1764791521769,"env":"test","module":"ai-service","error":{"code":"VALIDATION_ERROR"},"duration":1,"msg":"AI workflow generation failed"}
{"level":50,"time":1764791521774,"env":"test","module":"ai-service","error":{"code":"VALIDATION_ERROR"},"duration":1,"msg":"AI workflow generation failed"}
{"level":50,"time":1764791521777,"env":"test","module":"ai-service","error":{"code":"VALIDATION_ERROR"},"duration":1,"msg":"AI workflow generation failed"}
{"level":50,"time":1764791521780,"env":"test","module":"ai-service","error":{"code":"RATE_LIMIT","details":{"originalError":"Rate limit exceeded"}},"duration":0,"msg":"AI workflow generation failed"}
{"level":50,"time":1764791521785,"env":"test","module":"ai-service","error":{},"duration":1,"msg":"AI workflow generation failed"}
{"level":30,"time":1764791521790,"env":"test","module":"ai-service","duration":1,"sectionsCount":1,"rulesCount":0,"blocksCount":0,"msg":"AI workflow generation succeeded"}
{"level":30,"time":1764791521792,"env":"test","module":"ai-service","duration":1,"sectionsCount":1,"rulesCount":0,"blocksCount":0,"msg":"AI workflow generation succeeded"}
{"level":30,"time":1764791521795,"env":"test","module":"ai-service","duration":0,"suggestionsCount":1,"msg":"AI binding suggestion succeeded"}
{"level":30,"time":1764791521810,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791521811,"env":"test","module":"auth","email":"logout@example.com","msg":"Token verified successfully"}
 [32mÎ“Â£Ã´[39m tests/unit/ai.service.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 48[2mms[22m[39m
{"level":40,"time":1764791521878,"env":"test","module":"rbac-middleware","userId":"rRs42d82JRTwtVsyOpnmv","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
{"level":40,"time":1764791521884,"env":"test","module":"auth-middleware","path":"/api/workflows/3a924e08-848d-4ac7-bd7e-78e33948ad4e/move","msg":"No valid authentication found"}
[90mstdout[2m | tests/engine.run-conditions.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791521973,"env":"test","module":"auth","userId":"google-user-logout","msg":"User upserted successfully"}
[90mstdout[2m | tests/unit/auth/googleAuth.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¶Ã¦ add access controls to secrets: https://dotenvx.com/ops

{"level":30,"time":1764791522077,"env":"test","module":"auth","email":"logout@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791522082,"env":"test","module":"auth","email":"logout@example.com","msg":"User logged out"}
{"level":40,"time":1764791522086,"env":"test","module":"auth-middleware","path":"/api/auth/user","msg":"No valid authentication found"}
{"level":30,"time":1764791522089,"env":"test","module":"auth","hasToken":true,"origin":"http://localhost:5000","ip":"::1","msg":"OAuth2 login attempt"}
{"level":30,"time":1764791522090,"env":"test","module":"auth","email":"cookieclear@example.com","msg":"Token verified successfully"}
{"level":30,"time":1764791522150,"env":"test","module":"user-credentials-repository","userId":"Krr_w_mjpgYyGLlgtyj8n","msg":"User credentials created"}
{"level":30,"time":1764791522151,"env":"test","module":"auth-routes","userId":"Krr_w_mjpgYyGLlgtyj8n","email":"viewer-TTwty7VYmOkHDhyx5I2Os@example.com","msg":"User registered successfully"}
[90mstdout[2m | tests/integration/api.snapshots.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":40,"time":1764791522215,"env":"test","module":"rbac-middleware","userId":"rRs42d82JRTwtVsyOpnmv","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
{"level":40,"time":1764791522224,"env":"test","module":"auth-middleware","path":"/api/workflows/e035ed58-2088-48f4-a852-06752516d697/move","msg":"No valid authentication found"}
[90mstdout[2m | tests/unit/workflows/conditionTruthTable.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791522255,"env":"test","module":"auth","userId":"google-user-cookie-clear","msg":"User upserted successfully"}
{"level":40,"time":1764791522259,"env":"test","module":"rbac-middleware","userId":"Krr_w_mjpgYyGLlgtyj8n","userRole":"viewer","permission":"workflow:run","path":"/workflows/1add583f-9381-437e-a986-830d1d7c077c/run","msg":"Permission denied"}
[90mstdout[2m | tests/engine.run-conditions.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/workflows/conditionTruthTable.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/workflows/conditionTruthTable.test.ts [2m([22m[2m51 tests[22m[2m)[22m[32m 24[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/engine.run-conditions.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 292[2mms[22m[39m
{"level":30,"time":1764791522371,"env":"test","module":"auth","email":"cookieclear@example.com","msg":"OAuth2 login successful"}
{"level":30,"time":1764791522377,"env":"test","module":"auth","email":"cookieclear@example.com","msg":"User logged out"}
 [32mÎ“Â£Ã´[39m tests/integration/api.snapshots.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 1145[2mms[22m[39m
     [33m[2mÎ“Â£Ã´[22m[39m should maintain immutability of runs across versions [33m 628[2mms[22m[39m
[90mstdout[2m | tests/integration/auth-oauth.integration.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/auth/googleAuth.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/api.runs.graph.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":40,"time":1764791522558,"env":"test","module":"rbac-middleware","userId":"rRs42d82JRTwtVsyOpnmv","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
[90mstdout[2m | tests/unit/services/PdfQueueService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":50,"time":1764791522621,"env":"test","error":{"issues":[{"validation":"uuid","code":"invalid_string","message":"Invalid uuid","path":["projectId"]}],"name":"ZodError"},"workflowId":"6c56a7b2-9be6-4c93-9c10-9d61c8db372b","userId":"rRs42d82JRTwtVsyOpnmv","projectId":"invalid-uuid","msg":"Error moving workflow"}
[90mstdout[2m | tests/unit/auth/googleAuth.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/PdfQueueService.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 11474[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should enqueue a PDF conversion job [33m 906[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should create output with empty storagePath initially [33m 692[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return job status for pending job [33m 666[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return null for non-existent job [33m 616[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should parse attempt count from error field [33m 681[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should convert DOCX to PDF immediately [33m 723[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should handle conversion errors gracefully [33m 686[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should start and stop service [33m 760[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should not start if already running [33m 598[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should handle stop when not running [33m 567[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should process pending jobs when queue is processed [33m 998[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should process multiple jobs in batch [33m 1286[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should handle missing DOCX output gracefully [33m 794[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should support enqueue within transaction [33m 761[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should support convertImmediate within transaction [33m 735[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/integration/auth-oauth.integration.test.ts [2m([22m[2m19 tests[22m[2m)[22m[33m 13139[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should successfully authenticate with valid Google token and origin [33m 320[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should accept both 'token' and 'idToken' field names [33m 554[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should accept requests from localhost variants [33m 823[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should allow accessing protected routes after authentication [33m 375[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should maintain session across multiple requests [33m 603[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/unit/auth/googleAuth.test.ts [2m([22m[2m25 tests[22m[2m)[22m[32m 206[2mms[22m[39m
 [31mÎ“Â¥Â»[39m tests/integration/api.runs.graph.test.ts [2m([22m[2m19 tests[22m[2m)[22m[33m 4412[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should list all runs with pagination[32m 132[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should filter runs by status[32m 117[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should filter runs by workflow[32m 116[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should filter runs by project[32m 111[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should filter runs by date range[32m 107[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should search runs by query string[32m 120[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should get run by ID with all details[32m 169[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should return 404 for non-existent run[32m 116[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should get logs for a run[32m 219[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should re-run workflow with same inputs [33m 372[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should re-run workflow with override inputs [33m 372[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should return 404 for non-existent run[32m 111[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should export runs to CSV[32m 121[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should export runs with filters applied[32m 117[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should compare two runs [33m 316[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should identify changed input keys[32m 171[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should return 404 if run A not found[32m 118[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should return 404 if run B not found[32m 118[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should enforce tenant isolation on runs list [33m 581[2mms[22m[39m
[90mstdout[2m | tests/unit/services/docxHelpers.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/repositories/DatavaultRowsRepository.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/docxHelpers.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/repositories/DatavaultRowsRepository.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/docxHelpers.test.ts [2m([22m[2m39 tests[22m[2m)[22m[32m 50[2mms[22m[39m
{"level":40,"time":1764791522953,"env":"test","module":"rbac-middleware","userId":"rRs42d82JRTwtVsyOpnmv","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
 [32mÎ“Â£Ã´[39m tests/unit/repositories/DatavaultRowsRepository.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 37[2mms[22m[39m
[90mstdout[2m | tests/engine.expr.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/engine.expr.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":50,"time":1764791523012,"env":"test","error":{"issues":[{"code":"invalid_type","expected":"string","received":"undefined","path":["projectId"],"message":"Required"}],"name":"ZodError"},"workflowId":"7e0bd45c-55c0-4986-978a-87c3a662770e","userId":"rRs42d82JRTwtVsyOpnmv","msg":"Error moving workflow"}
 [32mÎ“Â£Ã´[39m tests/engine.expr.test.ts [2m([22m[2m26 tests[22m[2m)[22m[32m 36[2mms[22m[39m
{"level":40,"time":1764791523341,"env":"test","module":"rbac-middleware","userId":"rRs42d82JRTwtVsyOpnmv","userRole":"builder","permission":"project:create","path":"/","msg":"Permission denied"}
{"level":40,"time":1764791523352,"env":"test","module":"auth-middleware","path":"/","msg":"No valid authentication found"}
{"level":50,"time":1764791523412,"env":"test","error":{"issues":[{"code":"invalid_type","expected":"string","received":"undefined","path":["projectId"],"message":"Required"}],"name":"ZodError"},"workflowId":"8350d7b3-2eca-4d17-ac07-7990404cbc89","userId":"rRs42d82JRTwtVsyOpnmv","msg":"Error moving workflow"}
[90mstdout[2m | tests/integration/api.workflows.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/services/TemplateAnalysisService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/DocumentTemplateService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¶Ã‰ prevent building .env in docker: https://dotenvx.com/prebuild

[90mstdout[2m | tests/unit/services/TemplateAnalysisService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/TemplateAnalysisService.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 30[2mms[22m[39m
 [31mÎ“Â¥Â»[39m tests/integration/api.workflows.test.ts [2m([22m[2m17 tests[22m[2m | [22m[31m14 failed[39m[2m)[22m[33m 5487[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should create a new draft workflow[39m[32m 66[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should reject without permission [33m 329[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should list workflows[39m[32m 113[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should filter by status[39m[32m 138[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should search by name[39m[32m 174[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should update draft workflow[39m[32m 112[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should not allow editing published workflow[39m[32m 119[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should publish workflow[39m[32m 118[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should list workflow versions[39m[32m 168[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should move workflow to a project[39m[33m 382[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should move workflow to Main Folder (projectId = null)[39m[33m 675[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should reject move to non-existent project [33m 492[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should reject move without authentication [33m 336[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should reject move of workflow user does not own[39m[33m 341[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should reject move with invalid projectId format[39m[33m 398[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should reject move without projectId in body[39m[33m 391[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should reject move to project user does not have access to[39m[33m 400[2mms[22m[39m
[90mstdout[2m | tests/integration/auth.integration.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791523902,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1764791523902,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1764791523917,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1764791523917,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1764791523917,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
{"level":30,"time":1764791523917,"env":"test","module":"routes","msg":"Real-time collaboration server initialized"}
{"level":40,"time":1764791523968,"env":"test","module":"auth-middleware","path":"/api/auth/user","msg":"No valid authentication found"}
[90mstdout[2m | tests/unit/services/DocumentTemplateService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791524015,"env":"test","module":"auth","hasToken":false,"ip":"::1","msg":"OAuth2 login attempt"}
{"level":40,"time":1764791524015,"env":"test","module":"auth","msg":"OAuth2 login failed: No token provided"}
[90mstdout[2m | tests/unit/schema/collections.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":30,"time":1764791524023,"env":"test","module":"auth","hasToken":true,"origin":"https://malicious-site.com","ip":"::1","msg":"OAuth2 login attempt"}
{"level":40,"time":1764791524024,"env":"test","module":"auth","origin":"https://malicious-site.com","msg":"OAuth2 login failed: Invalid origin"}
[90mstdout[2m | tests/unit/services/DocumentTemplateService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":30,"time":1764791524041,"env":"test","module":"auth","hasToken":true,"ip":"::1","msg":"OAuth2 login attempt"}
{"level":40,"time":1764791524041,"env":"test","module":"auth","msg":"OAuth2 login failed: Invalid origin"}
[90mstdout[2m | tests/unit/schema/collections.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":40,"time":1764791524050,"env":"test","module":"auth-middleware","path":"/api/auth/user","msg":"No valid authentication found"}
[90mstdout[2m | tests/unit/services/EmailTemplateMetadataService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/schema/collections.test.ts [2m([22m[2m34 tests[22m[2m)[22m[32m 32[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/unit/services/DocumentTemplateService.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 28[2mms[22m[39m
[90mstdout[2m | tests/unit/services/EmailTemplateMetadataService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/services/WorkflowService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  suppress all logs with { quiet: true }

 [32mÎ“Â£Ã´[39m tests/unit/services/EmailTemplateMetadataService.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 35[2mms[22m[39m
[90mstdout[2m | tests/unit/services/CollectionFieldService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¦Ã‘ sync secrets across teammates & machines: https://dotenvx.com/ops

[90mstdout[2m | tests/integration/auth.integration.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/integration/api.templates-runs.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/services/StepService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  override existing env vars with { override: true }

[90mstdout[2m | tests/unit/services/RecordService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Â¢Ã¡âˆ©â••Ã…  run anywhere with `dotenvx run -- yourcommand`

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mRow Notes[2m > [22m[2mshould create a note for a row
[22m[39mCreated note: 356bcca3-8e90-4a75-80a3-342d5f772d85 tenantId: 7f6b01de-c617-42a1-b39a-b3d35ad1ec95 userId: google-user-id

[90mstdout[2m | tests/unit/services/WorkflowService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/WorkflowService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/services/docxRenderer2.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/CollectionFieldService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/docxRenderer2.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/services/CollectionFieldService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/WorkflowService.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 39[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/unit/services/docxRenderer2.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 25[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/unit/services/CollectionFieldService.test.ts [2m([22m[2m23 tests[22m[2m)[22m[32m 41[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/integration/auth.integration.test.ts [2m([22m[2m11 tests[22m[2m)[22m[33m 443[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/integration/api.templates-runs.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 6383[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should list templates [33m 309[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should update template name [33m 328[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should delete template [33m 440[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should reject without required permission [33m 322[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should list runs [33m 398[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should filter by workflowId [33m 405[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should get run by ID [33m 442[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should get run logs [33m 528[2mms[22m[39m
[90mstdout[2m | tests/unit/services/RecordService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/repositories/WorkflowTemplateRepository.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/services/RecordService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mRow Notes[2m > [22m[2mshould get all notes for a row
[22m[39mCreated note: dccfbbbf-35bb-4ff5-be40-72c2d11150b7 tenantId: 7f6b01de-c617-42a1-b39a-b3d35ad1ec95 userId: google-user-id

[90mstdout[2m | tests/unit/services/StepService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/repositories/WorkflowTemplateRepository.test.ts [2m([22m[2m19 tests[22m[2m)[22m[33m 14313[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should create a workflow template mapping [33m 1005[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should create non-primary mapping by default [33m 679[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should find all templates for a workflow version [33m 762[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return empty array for version with no templates [33m 650[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should order by createdAt desc (newest first) [33m 768[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should find mapping by workflow version and key [33m 721[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return undefined for non-existent key [33m 644[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should find primary template for workflow version [33m 749[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return undefined when no primary template exists [33m 714[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should set a template as primary and unset others [33m 943[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should handle setting primary when none existed before [33m 928[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should not delete mapping if workflow version does not match [33m 870[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return true if key exists in workflow version [33m 700[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return false if key does not exist [33m 642[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should exclude specified id when checking existence [33m 709[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return true if key exists on different mapping [33m 755[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should update mapping fields [33m 713[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should find mapping by id [33m 716[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return undefined for non-existent id [33m 638[2mms[22m[39m
[90mstdout[2m | tests/unit/utils/encryption.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/StepService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/utils/encryption.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/RecordService.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 29[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/unit/utils/encryption.test.ts [2m([22m[2m29 tests[22m[2m)[22m[32m 26[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/unit/services/StepService.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 27[2mms[22m[39m
[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mRow Notes[2m > [22m[2mshould get all notes for a row
[22m[39mCreated note: dec3b9db-0d32-4479-9153-0fa7ffc9cd5b tenantId: 7f6b01de-c617-42a1-b39a-b3d35ad1ec95 userId: google-user-id

[90mstdout[2m | tests/unit/repositories/DocumentTemplateRepository.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¶Ã‰ encrypt with Dotenvx: https://dotenvx.com

[90mstdout[2m | tests/unit/services/intakeQuestionVisibility.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/utils/pagination.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

{"level":50,"time":1764791525488,"env":"test","module":"intake-question-visibility","error":{},"questionId":"q1","condition":{"op":"invalid","left":null,"right":null},"msg":"Error evaluating visibleIf condition"}
[90mstdout[2m | tests/unit/services/intakeQuestionVisibility.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/repositories/DocumentTemplateRepository.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/utils/pagination.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/intakeQuestionVisibility.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 36[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/unit/utils/pagination.test.ts [2m([22m[2m24 tests[22m[2m)[22m[32m 29[2mms[22m[39m
[90mstdout[2m | tests/unit/repositories/DocumentTemplateRepository.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/services/intakeNavigation.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/repositories/DocumentTemplateRepository.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 35[2mms[22m[39m
{"level":50,"time":1764791525618,"env":"test","module":"intake-navigation","error":{},"pageId":"page1","condition":{"op":"invalid","left":null,"right":null},"msg":"Error evaluating visibleIf condition"}
[90mstdout[2m | tests/unit/services/intakeNavigation.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":50,"time":1764791525626,"env":"test","module":"intake-navigation","error":{},"pageId":"page1","condition":{"op":"invalid","left":null,"right":null},"msg":"Error evaluating skipIf condition"}
 [32mÎ“Â£Ã´[39m tests/unit/services/intakeNavigation.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 28[2mms[22m[39m
[90mstdout[2m | tests/unit/utils/conditionalLogic.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/DatavaultTablesService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“Â£Ã  audit secrets and track compliance: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/utils/conditionalLogic.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/utils/conditionalLogic.test.ts [2m([22m[2m29 tests[22m[2m)[22m[32m 17[2mms[22m[39m
[90mstdout[2m | tests/unit/captcha.service.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/captcha.service.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/services/BrandingService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/captcha.service.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 19[2mms[22m[39m
[90mstdout[2m | tests/unit/services/BrandingService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mRow Notes[2m > [22m[2mshould delete a note
[22m[39mCreated note: a7866156-1a59-4df9-851f-634ec5885936 tenantId: 7f6b01de-c617-42a1-b39a-b3d35ad1ec95 userId: google-user-id

 [32mÎ“Â£Ã´[39m tests/unit/services/BrandingService.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 34[2mms[22m[39m
[90mstdout[2m | tests/unit/services/CollectionService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¦Ã‘ sync secrets across teammates & machines: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/services/DatavaultTablesService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/DatavaultTablesService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/schema/documentEngine.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/schema/documentEngine.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/DatavaultTablesService.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/unit/schema/documentEngine.test.ts [2m([22m[2m33 tests[22m[2m)[22m[32m 22[2mms[22m[39m
[90mstdout[2m | tests/unit/services/repeater.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/repeater.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/repeater.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 19[2mms[22m[39m
[90mstdout[2m | tests/unit/repositories/DatavaultColumnsRepository.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  load multiple .env files with { path: ['.env.local', '.env'] }

[90mstdout[2m | tests/unit/utils/variableResolver.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/api.ai.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/utils/variableResolver.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/integration/api.ai.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/utils/variableResolver.test.ts [2m([22m[2m20 tests[22m[2m)[22m[32m 15[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/integration/api.ai.test.ts [2m([22m[2m32 tests[22m[2m)[22m[32m 13[2mms[22m[39m
[90mstdout[2m | tests/integration/intake.portal.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/services/CollectionService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/intake.portal.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/integration/intake.portal.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 10[2mms[22m[39m
[90mstdout[2m | tests/unit/services/CollectionService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/services/CollectionService.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 24[2mms[22m[39m
[90mstdout[2m | tests/unit/repositories/DatavaultTablesRepository.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¦Ã‘ sync secrets across teammates & machines: https://dotenvx.com/ops

[90mstdout[2m | tests/unit/repositories/DatavaultColumnsRepository.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/repositories/DatavaultColumnsRepository.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/repositories/DatavaultColumnsRepository.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 18[2mms[22m[39m
{"level":40,"time":1764791526598,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
[90mstdout[2m | tests/unit/repositories/DatavaultTablesRepository.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/repositories/DatavaultTablesRepository.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/unit/utils/conditionalLogic-simple.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/unit/utils/conditionalLogic-simple.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mRow Notes[2m > [22m[2mshould not allow deleting notes by other users
[22m[39mCreated note: f55a459f-4b6b-46fe-b0f3-2a9bc64fb9e0 tenantId: 7f6b01de-c617-42a1-b39a-b3d35ad1ec95 userId: google-user-id

 [32mÎ“Â£Ã´[39m tests/unit/utils/conditionalLogic-simple.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 10[2mms[22m[39m
{"level":40,"time":1764791526686,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
 [32mÎ“Â£Ã´[39m tests/unit/repositories/DatavaultTablesRepository.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 24[2mms[22m[39m
{"level":40,"time":1764791526851,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
[90mstdout[2m | tests/ui/builder.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/ui/builder.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/ui/builder.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 11[2mms[22m[39m
{"level":50,"time":1764791527016,"env":"test","error":{},"msg":"Error deleting row note"}
{"level":40,"time":1764791527075,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
{"level":40,"time":1764791527156,"env":"test","module":"auth-service","msg":"JWT_SECRET not set - falling back to SESSION_SECRET. This is acceptable for development but should be fixed for production."}
 [2m[90mÎ“Ã¥Ã´[39m[22m tests/collab.server.test.ts [2m([22m[2m14 tests[22m[2m | [22m[33m14 skipped[39m[2m)[22m
[90mstdout[2m | tests/integration/datavault.routes.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¹Ã©âˆ©â••Ã… backup and recover secrets: https://dotenvx.com/ops

[90mstdout[2m | tests/integration/branding.routes.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  load multiple .env files with { path: ['.env.local', '.env'] }

[90mstdout[2m | tests/services/BrandingService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  specify custom .env file path with { path: '/custom/path/.env' }

[90mstdout[2m | tests/services/EmailTemplateMetadataService.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¦Ã‘ sync secrets across teammates & machines: https://dotenvx.com/ops

[90mstdout[2m | tests/integration/datavault.api-tokens.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: â‰¡Æ’Ã¶Ã¦ add access controls to secrets: https://dotenvx.com/ops

[90mstdout[2m | tests/integration/branding.routes.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/branding.routes.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/integration/branding.routes.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 12[2mms[22m[39m
[90mstdout[2m | tests/services/BrandingService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/services/BrandingService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

[90mstdout[2m | tests/services/EmailTemplateMetadataService.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/services/EmailTemplateMetadataService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/services/BrandingService.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [32mÎ“Â£Ã´[39m tests/services/EmailTemplateMetadataService.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 7[2mms[22m[39m
[90mstdout[2m | tests/integration/datavault.row-notes.test.ts
[22m[39m[dotenv@17.2.3] injecting env (11) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  suppress all logs with { quiet: true }

[90mstdout[2m | tests/integration/datavault.api-tokens.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/datavault.api-tokens.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/integration/datavault.api-tokens.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 12[2mms[22m[39m
[90mstdout[2m | tests/unit/engine/templateNode.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/unit/engine/templateNode.test.ts [2m([22m[2m17 tests[22m[2m)[22m[33m 17187[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should resolve template by key from workflowTemplates mapping [33m 1279[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should throw error if template key not found [33m 962[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should store output in runOutputs table [33m 1126[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should resolve template by templateId directly [33m 1007[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should throw error if templateId not found [33m 953[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should use docxRenderer2 by default (v2 engine) [33m 1008[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should use legacy engine when engine="legacy" [33m 971[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should generate PDF when toPdf=true [33m 1124[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should default to DOCX when toPdf=false [33m 1119[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should skip execution when condition evaluates to false [33m 887[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should execute when condition evaluates to true [33m 956[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should resolve simple bindings [33m 943[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should handle binding resolution errors gracefully [33m 949[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should record failed output in runOutputs table [33m 1080[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should not throw errors (should return error in result) [33m 952[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should deny access to templates from different tenant [33m 973[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should require either templateKey or templateId [33m 893[2mms[22m[39m
{"level":40,"time":1764791528441,"env":"test","module":"auth-middleware","path":"/datavault/databases/2ba50338-b416-497f-a32c-3610bfcf6cd5/tables","msg":"No valid authentication found"}
[90mstdout[2m | tests/integration/datavault.routes.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/datavault.routes.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/integration/datavault.routes.test.ts [2m([22m[2m29 tests[22m[2m)[22m[32m 14[2mms[22m[39m
[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould grant table permission
[22m[39mupsert result: {"id":"949dfc3f-43ec-432f-89e0-741b3be9f56e","tableId":"31ffb70a-6865-4766-a42d-1caf217d67f5","userId":"other-user-id","role":"read","createdAt":"2025-12-03T19:52:10.277Z"}

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould grant table permission
[22m[39mGrant permission success, sending 201. Permission: {"id":"949dfc3f-43ec-432f-89e0-741b3be9f56e","tableId":"31ffb70a-6865-4766-a42d-1caf217d67f5","userId":"other-user-id","role":"read","createdAt":"2025-12-03T19:52:10.277Z"}

[90mstdout[2m | tests/integration/datavault.row-notes.test.ts
[22m[39mâ‰¡Æ’ÂºÂ¬ Setting up test environment...

[90mstdout[2m | tests/integration/datavault.row-notes.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/integration/datavault.row-notes.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 9[2mms[22m[39m
[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould update table permission role
[22m[39mupsert result: {"id":"b824122c-123d-4364-b652-046096a8fea3","tableId":"6e14046f-ae85-427c-a627-2ef9e78bade3","userId":"other-user-id","role":"read","createdAt":"2025-12-03T19:52:10.972Z"}

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould update table permission role
[22m[39mGrant permission success, sending 201. Permission: {"id":"b824122c-123d-4364-b652-046096a8fea3","tableId":"6e14046f-ae85-427c-a627-2ef9e78bade3","userId":"other-user-id","role":"read","createdAt":"2025-12-03T19:52:10.972Z"}

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould update table permission role
[22m[39mupsert result: {"id":"b824122c-123d-4364-b652-046096a8fea3","tableId":"6e14046f-ae85-427c-a627-2ef9e78bade3","userId":"other-user-id","role":"write","createdAt":"2025-12-03T19:52:10.972Z"}

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould update table permission role
[22m[39mGrant permission success, sending 201. Permission: {"id":"b824122c-123d-4364-b652-046096a8fea3","tableId":"6e14046f-ae85-427c-a627-2ef9e78bade3","userId":"other-user-id","role":"write","createdAt":"2025-12-03T19:52:10.972Z"}

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould update table permission role
[22m[39mUpdate permission failed: {
  id: [32m'b824122c-123d-4364-b652-046096a8fea3'[39m,
  tableId: [32m'6e14046f-ae85-427c-a627-2ef9e78bade3'[39m,
  userId: [32m'other-user-id'[39m,
  role: [32m'write'[39m,
  createdAt: [32m'2025-12-03T19:52:10.972Z'[39m
}

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould revoke table permission
[22m[39mupsert result: {"id":"53acbbec-a1c8-4b59-9574-ae0b259ca87f","tableId":"096f6f7f-978a-41a5-bbfb-c177481ef1f0","userId":"other-user-id","role":"read","createdAt":"2025-12-03T19:52:11.598Z"}

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould revoke table permission
[22m[39mGrant permission success, sending 201. Permission: {"id":"53acbbec-a1c8-4b59-9574-ae0b259ca87f","tableId":"096f6f7f-978a-41a5-bbfb-c177481ef1f0","userId":"other-user-id","role":"read","createdAt":"2025-12-03T19:52:11.598Z"}

[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould revoke table permission
[22m[39mrevokePermission called for permission: 53acbbec-a1c8-4b59-9574-ae0b259ca87f

[90mstdout[2m | tests/unit/services/WorkflowTemplateService.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [31mÎ“Â¥Â»[39m tests/unit/services/WorkflowTemplateService.test.ts [2m([22m[2m21 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 19592[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should throw error if template belongs to different project [33m 1103[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should automatically unset other primaries when setting new primary [33m 1271[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should list all templates for workflow version [33m 993[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should return empty array for version with no templates [33m 735[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should get template mapping by id and version [33m 915[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should throw error if mapping not found [33m 725[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should get template by key [33m 883[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should throw error if key not found [33m 737[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should get primary template for workflow version [33m 1002[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should return null when no primary template exists [33m 867[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should update mapping key [33m 932[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should update isPrimary flag [33m 987[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should throw error if new key already exists [33m 1005[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should throw error if mapping not found [33m 742[2mms[22m[39m
[31m         [31mâ”œÃ¹[31m should unset other primaries when setting isPrimary to true[39m[33m 1046[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should detach template from workflow version [33m 956[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should throw error if mapping not found [33m 739[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should set template as primary [33m 1236[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should throw error if mapping not found [33m 731[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should support operations within a transaction [33m 980[2mms[22m[39m
         [33m[2mÎ“Â£Ã´[22m[39m should rollback on transaction error [33m 1002[2mms[22m[39m
{"level":50,"time":1764791530778,"env":"test","error":{},"msg":"Error granting table permission"}
[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mTable Permissions[2m > [22m[2mshould enforce RBAC - only owners can manage permissions
[22m[39mGrant permission catch block entered Error: Access denied - owner permission required
    at DatavaultTablePermissionsService.requirePermission (C:/Users/scoot/poll/VaultLogic/server/services/DatavaultTablePermissionsService.ts:108:13)
[90m    at processTicksAndRejections (node:internal/process/task_queues:103:5)[39m
    at DatavaultTablePermissionsService.grantPermission (C:/Users/scoot/poll/VaultLogic/server/services/DatavaultTablePermissionsService.ts:138:5)
    at C:/Users/scoot/poll/VaultLogic/server/routes/datavault.routes.ts:1155:26

{"level":50,"time":1764791532218,"env":"test","error":{"issues":[{"received":"invalid_type","code":"invalid_enum_value","options":["text","number","boolean","date","datetime","email","phone","url","json","auto_number","autonumber","reference","select","multiselect"],"path":["type"],"message":"Invalid enum value. Expected 'text' | 'number' | 'boolean' | 'date' | 'datetime' | 'email' | 'phone' | 'url' | 'json' | 'auto_number' | 'autonumber' | 'reference' | 'select' | 'multiselect', received 'invalid_type'"}],"name":"ZodError"},"msg":"Error creating DataVault column"}
{"level":50,"time":1764791533051,"env":"test","error":{},"msg":"Error creating DataVault row"}
[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts[2m > [22m[2mDataVault v4 Regression Tests[2m > [22m[2mError Handling[2m > [22m[2mshould return user-friendly error for missing required fields
[22m[39mRow creation error message: Required column 'Required Field' is missing

{"level":50,"time":1764791533313,"env":"test","error":{"length":144,"name":"error","severity":"ERROR","code":"22P02","where":"unnamed portal parameter $1 = '...'","file":"uuid.c","line":"138","routine":"string_to_uuid"},"msg":"Error fetching DataVault rows"}
[90mstdout[2m | tests/integration/datavault-v4-regression.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

 [32mÎ“Â£Ã´[39m tests/integration/datavault-v4-regression.test.ts [2m([22m[2m27 tests[22m[2m | [22m[33m4 skipped[39m[2m)[22m[33m 15380[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should create a select column with options [33m 492[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should create a multiselect column with options [33m 486[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should validate select value against options [33m 1488[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should validate multiselect values as array [33m 1025[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should create an autonumber column with sequence [33m 487[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should format autonumber with prefix [33m 1099[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should create a note for a row [33m 476[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should get all notes for a row [33m 953[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should delete a note [33m 874[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should not allow deleting notes by other users [33m 757[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should create an API token [33m 375[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should revoke (delete) an API token [33m 674[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should grant table permission [33m 353[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should list table permissions [33m 310[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should update table permission role [33m 640[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should revoke table permission [33m 736[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should paginate rows efficiently [33m 1191[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should return user-friendly error for missing required fields [33m 832[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Suites 9 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL  tests/integration/api.expression-validation.test.ts > Expression Validation API Integration Tests
Error: expected 201 "Created", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/api.expression-validation.test.ts:101:8
     99|         },
    100|       })
    101|       .expect(201);
       |        ^
    102| 
    103|     workflowId = workflowResponse.body.id;
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/24]Î“Ã„Â»

 FAIL  tests/integration/api.runs.docx.test.ts > Runs API - DOCX Generation Integration Tests
Error: expected 201 "Created", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/api.runs.docx.test.ts:125:8
    123|       .set('Authorization', `Bearer ${authToken}`)
    124|       .send({ name: 'DOCX Test Project' })
    125|       .expect(201);
       |        ^
    126|     projectId = projectResponse.body.id;
    127| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/24]Î“Ã„Â»

 FAIL  tests/integration/api.runs.graph.test.ts > Stage 8: Runs API Integration Tests
error: update or delete on table "users" violates foreign key constraint "runs_created_by_users_id_fk" on table "runs"
 Î“Â¥Â» node_modules/@neondatabase/serverless/index.mjs:1345:74
 Î“Â¥Â» tests/integration/api.runs.graph.test.ts:219:7
    217|   afterAll(async () => {
    218|     if (tenantId) {
    219|       await db.delete(schema.tenants).where(eq(schema.tenants.id, tenaÎ“Ã‡Âª
       |       ^
    220|     }
    221|     if (server) {

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests
error: update or delete on table "users" violates foreign key constraint "workflows_creator_id_users_id_fk" on table "workflows"
 Î“Â¥Â» node_modules/@neondatabase/serverless/index.mjs:1345:74
 Î“Â¥Â» tests/integration/api.workflows.test.ts:73:7
     71|   afterAll(async () => {
     72|     if (tenantId) {
     73|       await db.delete(schema.tenants).where(eq(schema.tenants.id, tenaÎ“Ã‡Âª
       |       ^
     74|     }
     75|     if (server) {

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/24]Î“Ã„Â»

 FAIL  tests/integration/collections.e2e.test.ts > Collections System E2E Tests
error: null value in column "title" of relation "projects" violates not-null constraint
 Î“Â¥Â» node_modules/@neondatabase/serverless/index.mjs:1345:74
 Î“Â¥Â» NeonPreparedQuery.execute node_modules/drizzle-orm/neon-serverless/session.js:76:20
 Î“Â¥Â» tests/integration/collections.e2e.test.ts:40:23
     38| 
     39|     // Create test project
     40|     const [project] = await db.insert(projects).values({
       |                       ^
     41|       name: 'E2E Test Project',
     42|       description: 'Project for collections E2E tests',

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/24]Î“Ã„Â»

 FAIL  tests/integration/datavault.autonumber.test.ts > DataVault Autonumber Integration Tests
TypeError: Cannot read properties of undefined (reading 'toLowerCase')
 Î“Â¥Â» DatavaultTablesService.generateSlug server/services/DatavaultTablesService.ts:113:8
    111|   private generateSlug(name: string): string {
    112|     return name
    113|       .toLowerCase()
       |        ^
    114|       .trim()
    115|       .replace(/[^a-z0-9]+/g, '-')
 Î“Â¥Â» DatavaultTablesService.createTable server/services/DatavaultTablesService.ts:165:40
 Î“Â¥Â» tests/integration/datavault.autonumber.test.ts:28:48

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/24]Î“Ã„Â»

 FAIL  tests/integration/datavault.databases.test.ts [ tests/integration/datavault.databases.test.ts ]
Error: Cannot find module '../../server/routes/datavaultDatabases' imported from 'C:/Users/scoot/poll/VaultLogic/tests/integration/datavault.databases.test.ts'
 Î“Â¥Â» tests/integration/datavault.databases.test.ts:4:1
      2| import request from 'supertest';
      3| import express, { type Express } from 'express';
      4| import datavaultDatabasesRouter from '../../server/routes/datavaultDatÎ“Ã‡Âª
       | ^
      5| import { db } from '../../server/db';
      6| import { datavaultDatabases, datavaultTables } from '@shared/schema';

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/24]Î“Ã„Â»

 FAIL  tests/integration/datavault.permissions.test.ts [ tests/integration/datavault.permissions.test.ts ]
Error: Cannot find module '../../server/app' imported from 'C:/Users/scoot/poll/VaultLogic/tests/integration/datavault.permissions.test.ts'
 Î“Â¥Â» tests/integration/datavault.permissions.test.ts:3:1
      1| import { describe, it, expect, beforeAll, afterAll } from 'vitest';
      2| import request from 'supertest';
      3| import { app } from '../../server/app';
       | ^
      4| import { db } from '../../server/db';
      5| import { users, tenants, datavaultTables, datavaultTablePermissions } Î“Ã‡Âª

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/24]Î“Ã„Â»

 FAIL  tests/ui/expression-editor.test.ts [ tests/ui/expression-editor.test.ts ]
Error: Transform failed with 1 error:
C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.ts:22:25: ERROR: Expected ">" but found "client"
  Plugin: vite:esbuild
  File: C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.ts:22:25
  
  Expected ">" but found "client"
  20 |  
  21 |    return ({ children }: { children: React.ReactNode }) => (
  22 |      <QueryClientProvider client={queryClient}>
     |                           ^
  23 |        {children}
  24 |      </QueryClientProvider>
  
 Î“Â¥Â» failureErrorWithLog node_modules/esbuild/lib/main.js:1467:15
 Î“Â¥Â» node_modules/esbuild/lib/main.js:736:50
 Î“Â¥Â» responseCallbacks.<computed> node_modules/esbuild/lib/main.js:603:9
 Î“Â¥Â» handleIncomingPacket node_modules/esbuild/lib/main.js:658:12
 Î“Â¥Â» Socket.readFromStdout node_modules/esbuild/lib/main.js:581:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[9/24]Î“Ã„Â»


Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 15 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > POST /api/projects/:projectId/workflows > should create a new draft workflow
Error: expected 201 "Created", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:91:10
     89|           graphJson: { nodes: [], edges: [] },
     90|         })
     91|         .expect(201);
       |          ^
     92| 
     93|       expect(response.body).toHaveProperty("id");
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[10/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > GET /api/projects/:projectId/workflows > should list workflows
Error: expected 200 "OK", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:132:10
    130|         .get(`/api/projects/${projectId}/workflows`)
    131|         .set("Authorization", `Bearer ${authToken}`)
    132|         .expect(200);
       |          ^
    133| 
    134|       expect(response.body).toHaveProperty("items");
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[11/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > GET /api/projects/:projectId/workflows > should filter by status
Error: expected 200 "OK", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:143:10
    141|         .get(`/api/projects/${projectId}/workflows?status=draft`)
    142|         .set("Authorization", `Bearer ${authToken}`)
    143|         .expect(200);
       |          ^
    144| 
    145|       expect(response.body.items.every((w: any) => w.status === "draftÎ“Ã‡Âª
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[12/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > GET /api/projects/:projectId/workflows > should search by name
Error: expected 200 "OK", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:158:10
    156|         .get(`/api/projects/${projectId}/workflows?q=${uniqueName}`)
    157|         .set("Authorization", `Bearer ${authToken}`)
    158|         .expect(200);
       |          ^
    159| 
    160|       expect(response.body.items.length).toBeGreaterThan(0);
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[13/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > PATCH /api/workflows/:id > should update draft workflow
Error: expected 200 "OK", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:180:10
    178|         .set("Authorization", `Bearer ${authToken}`)
    179|         .send({ name: "Updated Name" })
    180|         .expect(200);
       |          ^
    181| 
    182|       expect(response.body).toHaveProperty("name", "Updated Name");
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[14/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > PATCH /api/workflows/:id > should not allow editing published workflow
Error: expected 200 "OK", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:190:10
    188|         .post(`/api/workflows/${workflowId}/publish`)
    189|         .set("Authorization", `Bearer ${authToken}`)
    190|         .expect(200);
       |          ^
    191| 
    192|       // Try to edit
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[15/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > POST /api/workflows/:id/publish > should publish workflow
Error: expected 200 "OK", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:216:10
    214|         .post(`/api/workflows/${workflowId}/publish`)
    215|         .set("Authorization", `Bearer ${authToken}`)
    216|         .expect(200);
       |          ^
    217| 
    218|       expect(response.body).toHaveProperty("status", "published");
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[16/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > GET /api/workflows/:id/versions > should list workflow versions
Error: expected 200 "OK", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:244:10
    242|         .get(`/api/workflows/${workflowId}/versions`)
    243|         .set("Authorization", `Bearer ${authToken}`)
    244|         .expect(200);
       |          ^
    245| 
    246|       expect(response.body).toHaveProperty("items");
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[17/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > PUT /api/workflows/:id/move > should move workflow to a project
Error: expected 200 "OK", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:283:10
    281|         .set("Authorization", `Bearer ${authToken}`)
    282|         .send({ projectId: targetProjectId })
    283|         .expect(200);
       |          ^
    284| 
    285|       expect(response.body).toHaveProperty("id", workflowId);
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[18/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > PUT /api/workflows/:id/move > should move workflow to Main Folder (projectId = null)
Error: expected 200 "OK", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:318:10
    316|         .get(`/api/workflows/${workflowId}`)
    317|         .set("Authorization", `Bearer ${authToken}`)
    318|         .expect(200);
       |          ^
    319| 
    320|       expect(verifyResponse.body.projectId).toBeNull();
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[19/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > PUT /api/workflows/:id/move > should reject move of workflow user does not own
Error: expected 403 "Forbidden", got 401 "Unauthorized"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:362:10
    360|         .set("Authorization", `Bearer ${authToken2}`)
    361|         .send({ projectId: targetProjectId })
    362|         .expect(403);
       |          ^
    363| 
    364|       expect(response.body).toHaveProperty("message");
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[20/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > PUT /api/workflows/:id/move > should reject move with invalid projectId format
Error: expected 400 "Bad Request", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:373:10
    371|         .set("Authorization", `Bearer ${authToken}`)
    372|         .send({ projectId: "invalid-uuid" })
    373|         .expect(400);
       |          ^
    374| 
    375|       expect(response.body).toHaveProperty("message");
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[21/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > PUT /api/workflows/:id/move > should reject move without projectId in body
Error: expected 400 "Bad Request", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:383:10
    381|         .set("Authorization", `Bearer ${authToken}`)
    382|         .send({})
    383|         .expect(400);
       |          ^
    384| 
    385|       expect(response.body).toHaveProperty("message");
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[22/24]Î“Ã„Â»

 FAIL  tests/integration/api.workflows.test.ts > Workflows API Integration Tests > PUT /api/workflows/:id/move > should reject move to project user does not have access to
Error: expected 403 "Forbidden", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/api.workflows.test.ts:418:10
    416|         .set("Authorization", `Bearer ${authToken}`)
    417|         .send({ projectId: user2ProjectId })
    418|         .expect(403);
       |          ^
    419| 
    420|       expect(response.body).toHaveProperty("message");
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:156:7
 Î“Â¥Â» Test.Request.callback node_modules/superagent/lib/node/index.js:857:3
 Î“Â¥Â» node_modules/superagent/lib/node/index.js:1102:18
 Î“Â¥Â» IncomingMessage.<anonymous> node_modules/superagent/lib/node/parsers/json.js:21:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[23/24]Î“Ã„Â»

 FAIL  tests/unit/services/WorkflowTemplateService.test.ts > WorkflowTemplateService > attachTemplate > updateTemplateMapping > should unset other primaries when setting isPrimary to true
error: insert or update on table "workflow_templates" violates foreign key constraint "workflow_templates_workflow_version_id_workflow_versions_id_fk"
 Î“Â¥Â» node_modules/@neondatabase/serverless/index.mjs:1345:74
 Î“Â¥Â» NeonPreparedQuery.execute node_modules/drizzle-orm/neon-serverless/session.js:76:20
 Î“Â¥Â» WorkflowTemplateRepository.create server/repositories/BaseRepository.ts:85:22
     83|     const database = this.getDb(tx);
     84| 
     85|     const [record] = await database
       |                      ^
     86|       .insert(this.table)
     87|       .values(data as any)
 Î“Â¥Â» WorkflowTemplateService.attachTemplate server/services/WorkflowTemplateService.ts:61:21
 Î“Â¥Â» tests/unit/services/WorkflowTemplateService.test.ts:400:23

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[24/24]Î“Ã„Â»


[2m Test Files [22m [1m[31m10 failed[39m[22m[2m | [22m[1m[32m56 passed[39m[22m[2m | [22m[33m1 skipped[39m[90m (67)[39m
[2m      Tests [22m [1m[31m15 failed[39m[22m[2m | [22m[1m[32m1062 passed[39m[22m[2m | [22m[33m65 skipped[39m[90m (1142)[39m
[2m   Start at [22m 13:51:47
[2m   Duration [22m 29.16s[2m (transform 33.43s, setup 2.65s, collect 139.42s, tests 122.44s, environment 21ms, prepare 3.94s)[22m

