npm warn Unknown project config "puppeteer_skip_download". This will stop working in the next major version of npm.

> ezbuildr@1.0.0 test
> cross-env VITEST_INTEGRATION=true vitest run --coverage tests/integration/lifecycle-hooks-execution.test.ts tests/integration/api.ai.personalization.test.ts tests/ui/expression-editor.test.tsx


[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90mC:/Users/scoot/poll/VaultLogic[39m
      [2mCoverage enabled with [22m[33mv8[39m

[90mstdout[2m | tests/integration/lifecycle-hooks-execution.test.ts
[22m[39mSETUP: Loading setup.ts...
[dotenv@17.2.3] injecting env (20) from .env -- tip: â‰¡Æ’Ã¹Ã©âˆ©â••Ã… backup and recover secrets: https://dotenvx.com/ops

[90mstdout[2m | tests/integration/api.ai.personalization.test.ts
[22m[39mSETUP: Loading setup.ts...
[dotenv@17.2.3] injecting env (20) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  write to custom object with { processEnv: myObject }

[90mstdout[2m | tests/ui/expression-editor.test.tsx
[22m[39mSETUP: Loading setup.ts...
[dotenv@17.2.3] injecting env (20) from .env -- tip: â‰¡Æ’Ã¦Ã‘ sync secrets across teammates & machines: https://dotenvx.com/ops

[90mstdout[2m | tests/integration/lifecycle-hooks-execution.test.ts
[22m[39m[dotenv@17.2.3] injecting env (0) from .env -- tip: â‰¡Æ’Ã¶Ã‰ prevent building .env in docker: https://dotenvx.com/prebuild
DB: Skipping auto-init because NODE_ENV=test

[90mstdout[2m | tests/integration/api.ai.personalization.test.ts
[22m[39m[dotenv@17.2.3] injecting env (0) from .env -- tip: â‰¡Æ’Ã¶Ã‰ prevent building .env in docker: https://dotenvx.com/prebuild
DB: Skipping auto-init because NODE_ENV=test

[90mstdout[2m | tests/ui/expression-editor.test.tsx
[22m[39m[SchemaManager] Reusing existing isolated schema: test_schema_w1
[SchemaManager] Detected Neon DB. Switching to Direct Connection (5432) for schema isolation.

[90mstdout[2m | tests/ui/expression-editor.test.tsx
[22m[39mâ‰¡Æ’Ã¶Ã† Test Schema Isolated: test_schema_w1 (Reused: true)

[90mstdout[2m | tests/ui/expression-editor.test.tsx
[22m[39m[dotenv@17.2.3] injecting env (0) from .env -- tip: â‰¡Æ’Â¢Ã¡âˆ©â••Ã…  run anywhere with `dotenvx run -- yourcommand`
DB: Skipping auto-init because NODE_ENV=test

{"level":30,"time":1768342003490,"env":"test","msg":"DB: initializing... Local"}
{"level":20,"time":1768342003490,"env":"test","msg":"DB: importing pg..."}
{"level":20,"time":1768342003490,"env":"test","msg":"DB: creating pool..."}
{"level":20,"time":1768342003491,"env":"test","msg":"DB: importing drizzle..."}
[90mstdout[2m | tests/ui/expression-editor.test.tsx
[22m[39mÎ“Â£Ã  Database initialized for tests
Î“Ã…âŒ Schema reused, skipping migrations.

{"level":20,"time":1768342003531,"env":"test","msg":"DB: created."}
{"level":30,"time":1768342003531,"env":"test","msg":"DB: initialized flag set."}
{"level":30,"time":1768342003602,"env":"test","module":"metrics-service","msg":"MetricsService initialized"}
{"level":30,"time":1768342003608,"env":"test","module":"metrics-service","msg":"MetricsService initialized"}
stderr | tests/ui/expression-editor.test.tsx > Expression Editor Hooks > useExpressionValidation > should validate expression after debounce
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13

stderr | tests/ui/expression-editor.test.tsx > Expression Editor Hooks > useExpressionValidation > should return validation errors for invalid expression
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13

[90mstdout[2m | tests/ui/expression-editor.test.tsx[2m > [22m[2mExpression Editor Hooks[2m > [22m[2museExpressionValidation[2m > [22m[2mshould return validation errors for invalid expression
[22m[39mValidation Result DEBUG: {"ok":false,"errors":[{"message":"Unknown identifier: unknown_var","start":{"line":0,"col":0},"end":{"line":0,"col":11}}]}
IsValid DEBUG: [33mfalse[39m

stderr | tests/ui/expression-editor.test.tsx > Expression Editor Hooks > useExpressionValidation > should debounce validation calls
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13

stderr | tests/ui/expression-editor.test.tsx > Expression Editor Hooks > useExpressionValidation > should not validate when workflowId or nodeId is missing
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13

stderr | tests/ui/expression-editor.test.tsx > Expression Editor Hooks > useExpressionValidation > should not validate when workflowId or nodeId is missing
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13

stderr | tests/ui/expression-editor.test.tsx > Expression Editor Hooks > Expression validation integration > should validate helper functions in expressions
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13

stderr | tests/ui/expression-editor.test.tsx > Expression Editor Hooks > Expression validation integration > should validate complex expressions with multiple helpers
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13

stderr | tests/ui/expression-editor.test.tsx > Expression Editor Hooks > Expression validation integration > should handle syntax errors
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13

stderr | tests/ui/expression-editor.test.tsx > Expression Editor Hooks > Expression Editor component behavior > should update validation when expression changes
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13

stderr | tests/ui/expression-editor.test.tsx > Expression Editor Hooks > Expression Editor component behavior > should update validation when expression changes
Warning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (C:\Users\scoot\poll\VaultLogic\node_modules\@testing-library\react\dist\pure.js:328:5)
    at QueryClientProvider (file:///C:/Users/scoot/poll/VaultLogic/node_modules/@tanstack/react-query/build/modern/QueryClientProvider.js:20:3)
    at C:/Users/scoot/poll/VaultLogic/tests/ui/expression-editor.test.tsx:19:13

{"level":30,"time":1768342005481,"env":"test","msg":"DB: closing pool..."}
[90mstdout[2m | tests/ui/expression-editor.test.tsx
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":30,"time":1768342005482,"env":"test","msg":"DB: pool closed."}
 [32mÎ“Â£Ã´[39m tests/ui/expression-editor.test.tsx [2m([22m[2m10 tests[22m[2m)[22m[33m 3049[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should update validation when expression changes [33m 308[2mms[22m[39m
[90mstdout[2m | tests/integration/lifecycle-hooks-execution.test.ts
[22m[39mÎ“Â£Ã  OpenAPI specification loaded successfully

[90mstdout[2m | tests/integration/api.ai.personalization.test.ts
[22m[39mÎ“Â£Ã  OpenAPI specification loaded successfully

[90mstdout[2m | tests/integration/api.ai.personalization.test.ts
[22m[39m[SchemaManager] Reusing existing isolated schema: test_schema_w2
[SchemaManager] Detected Neon DB. Switching to Direct Connection (5432) for schema isolation.

[90mstdout[2m | tests/integration/api.ai.personalization.test.ts
[22m[39mâ‰¡Æ’Ã¶Ã† Test Schema Isolated: test_schema_w2 (Reused: true)

{"level":30,"time":1768342009059,"env":"test","msg":"DB: initializing... Local"}
{"level":20,"time":1768342009059,"env":"test","msg":"DB: importing pg..."}
{"level":20,"time":1768342009059,"env":"test","msg":"DB: creating pool..."}
{"level":20,"time":1768342009060,"env":"test","msg":"DB: importing drizzle..."}
{"level":20,"time":1768342009084,"env":"test","msg":"DB: created."}
[90mstdout[2m | tests/integration/api.ai.personalization.test.ts
[22m[39mÎ“Â£Ã  Database initialized for tests
Î“Ã…âŒ Schema reused, skipping migrations.

{"level":30,"time":1768342009084,"env":"test","msg":"DB: initialized flag set."}
[90mstdout[2m | tests/integration/lifecycle-hooks-execution.test.ts
[22m[39m[SchemaManager] Reusing existing isolated schema: test_schema_w0
[SchemaManager] Detected Neon DB. Switching to Direct Connection (5432) for schema isolation.

[90mstdout[2m | tests/integration/lifecycle-hooks-execution.test.ts
[22m[39mâ‰¡Æ’Ã¶Ã† Test Schema Isolated: test_schema_w0 (Reused: true)

{"level":30,"time":1768342009240,"env":"test","msg":"DB: initializing... Local"}
{"level":20,"time":1768342009240,"env":"test","msg":"DB: importing pg..."}
{"level":20,"time":1768342009241,"env":"test","msg":"DB: creating pool..."}
{"level":20,"time":1768342009241,"env":"test","msg":"DB: importing drizzle..."}
{"level":20,"time":1768342009268,"env":"test","msg":"DB: created."}
[90mstdout[2m | tests/integration/lifecycle-hooks-execution.test.ts
[22m[39mÎ“Â£Ã  Database initialized for tests
Î“Ã…âŒ Schema reused, skipping migrations.

{"level":30,"time":1768342009268,"env":"test","msg":"DB: initialized flag set."}
{"level":30,"time":1768342009585,"env":"test","module":"metrics-routes","msg":"Metrics endpoint registered at GET /metrics"}
[90mstdout[2m | tests/integration/api.ai.personalization.test.ts[2m > [22m[2mPersonalization API Integration Tests
[22m[39mâ‰¡Æ’Ã´Ãœ API Documentation available at /api-docs
[Routes] E-Signature routes registered at /api/esign

{"level":30,"time":1768342009591,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1768342009591,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1768342009595,"env":"test","module":"documents-routes","msg":"Document routes registered"}
{"level":30,"time":1768342009793,"env":"test","msg":"DB: closing pool..."}
[90mstdout[2m | tests/integration/api.ai.personalization.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":30,"time":1768342009794,"env":"test","msg":"DB: pool closed."}
{"level":30,"time":1768342009796,"env":"test","module":"metrics-routes","msg":"Metrics endpoint registered at GET /metrics"}
{"level":30,"time":1768342009817,"env":"test","msg":"Real-time collaboration server initialized"}
[90mstdout[2m | tests/integration/lifecycle-hooks-execution.test.ts[2m > [22m[2mLifecycle Hooks Execution
[22m[39mâ‰¡Æ’Ã´Ãœ API Documentation available at /api-docs
[Routes] E-Signature routes registered at /api/esign

{"level":30,"time":1768342009804,"env":"test","module":"file-routes","outputsDir":"C:\\Users\\scoot\\poll\\VaultLogic\\server\\files\\outputs","msg":"Secure file routes registered"}
{"level":30,"time":1768342009805,"env":"test","module":"ai-routes","msg":"AI workflow generation routes registered"}
{"level":30,"time":1768342009810,"env":"test","module":"documents-routes","msg":"Document routes registered"}
{"level":30,"time":1768342009817,"env":"test","module":"collab-server","msg":"Initializing WebSocket collaboration server"}
{"level":40,"time":1768342009817,"env":"test","module":"collab-persistence","msg":"REDIS_URL not configured, multi-instance collab will not work"}
{"level":30,"time":1768342009817,"env":"test","module":"collab-server","msg":"WebSocket collaboration server attached to main HTTP server path /collab"}
{"level":30,"time":1768342009817,"env":"test","module":"collab-server","msg":"WebSocket collaboration server initialized"}
 [31mÎ“Â¥Â»[39m tests/integration/api.ai.personalization.test.ts [2m([22m[2m3 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 1165[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should rewrite text based on user settings[39m[32m 48[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should generate help text[39m[32m 8[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should update user settings[39m[32m 8[2mms[22m[39m
{"level":30,"time":1768342010305,"env":"test","module":"user-credentials-repository","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"User credentials created"}
{"level":30,"time":1768342010404,"env":"test","module":"email-queue","jobId":"30c015ae-8785-4eed-9541-584c633a012e","to":"test-Xy0cOqPCY0dz46iHmScLt@example.com","subject":"Verify Your Email - ezBuildr","msg":"Email added to queue"}
{"level":30,"time":1768342010460,"env":"test","module":"auth-routes","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","email":"test-Xy0cOqPCY0dz46iHmScLt@example.com","msg":"User registered"}
{"level":20,"time":1768342010665,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342010665,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342010666,"env":"test","module":"tenant-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","path":"/","msg":"Tenant validation successful"}
{"level":20,"time":1768342010666,"env":"test","module":"rbac-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","userRole":"owner","permission":"project:create","path":"/","msg":"Permission check passed"}
{"level":20,"time":1768342010928,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342010928,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342010978,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342010978,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342011026,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342011026,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342011137,"env":"test","hookId":"051b4dad-67ae-4e4a-9334-e751bf79d130","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"beforePage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342011240,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"d9715b02-d92f-4356-a4d9-f15c0d474757","phase":"beforePage","sectionId":"48ec4b86-b147-4f6e-9caa-6b50ca2a7c4b","hookCount":1,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342011240,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"d9715b02-d92f-4356-a4d9-f15c0d474757","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342011244,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342011248,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342011300,"env":"test","hookId":"051b4dad-67ae-4e4a-9334-e751bf79d130","hookName":"Log Page Entry","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342011358,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342011359,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342011407,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342011407,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342011458,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342011458,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342011560,"env":"test","hookId":"b60cfa79-1f91-4ec1-89fd-60219745624a","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"beforePage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342011664,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"be59c56d-da9f-487d-a16a-43c3bdb5e245","phase":"beforePage","sectionId":"48ec4b86-b147-4f6e-9caa-6b50ca2a7c4b","hookCount":2,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342011664,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"be59c56d-da9f-487d-a16a-43c3bdb5e245","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342011664,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342011665,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342011716,"env":"test","hookId":"051b4dad-67ae-4e4a-9334-e751bf79d130","hookName":"Log Page Entry","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342011716,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"be59c56d-da9f-487d-a16a-43c3bdb5e245","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342011716,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342011719,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342011770,"env":"test","hookId":"b60cfa79-1f91-4ec1-89fd-60219745624a","hookName":"Prefill Data","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342011822,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342011822,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342011873,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342011873,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342011923,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342011923,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342012023,"env":"test","hookId":"bae36024-6e52-42be-83af-0726dd2193fd","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"beforePage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342012125,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"dcbb7209-5263-475a-b913-778297ec8e4c","phase":"beforePage","sectionId":"48ec4b86-b147-4f6e-9caa-6b50ca2a7c4b","hookCount":3,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342012125,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"dcbb7209-5263-475a-b913-778297ec8e4c","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342012126,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342012127,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342012177,"env":"test","hookId":"051b4dad-67ae-4e4a-9334-e751bf79d130","hookName":"Log Page Entry","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342012177,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"dcbb7209-5263-475a-b913-778297ec8e4c","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342012177,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342012178,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342012228,"env":"test","hookId":"b60cfa79-1f91-4ec1-89fd-60219745624a","hookName":"Prefill Data","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342012228,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"dcbb7209-5263-475a-b913-778297ec8e4c","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342012228,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342012230,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342012281,"env":"test","hookId":"bae36024-6e52-42be-83af-0726dd2193fd","hookName":"Error Hook","error":"SandboxError: Intentional test error","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342012337,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342012337,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342012384,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342012384,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342012437,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342012437,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342012538,"env":"test","hookId":"b3bba7e7-05d7-4890-b32a-5eb5e950a490","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"afterPage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342012687,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"82d1e984-1899-480e-aaa8-eef584ce62ec","phase":"afterPage","sectionId":"48ec4b86-b147-4f6e-9caa-6b50ca2a7c4b","hookCount":1,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342012687,"env":"test","language":"javascript","inputKeys":["user_name"],"phase":"afterPage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"82d1e984-1899-480e-aaa8-eef584ce62ec","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342012688,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342012689,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342012739,"env":"test","hookId":"b3bba7e7-05d7-4890-b32a-5eb5e950a490","hookName":"Validate Submission","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342012791,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342012791,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342012839,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342012839,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342012886,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342012886,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342012985,"env":"test","hookId":"e7461c19-6f14-46df-910f-75311f13f7ef","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"afterPage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342013090,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"cd4577be-4ba9-4bd4-b95b-ac3f5eff4085","phase":"afterPage","sectionId":"48ec4b86-b147-4f6e-9caa-6b50ca2a7c4b","hookCount":2,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342013090,"env":"test","language":"javascript","inputKeys":["user_name"],"phase":"afterPage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"cd4577be-4ba9-4bd4-b95b-ac3f5eff4085","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342013090,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342013092,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342013141,"env":"test","hookId":"b3bba7e7-05d7-4890-b32a-5eb5e950a490","hookName":"Validate Submission","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342013142,"env":"test","language":"python","inputKeys":["user_name"],"phase":"afterPage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"cd4577be-4ba9-4bd4-b95b-ac3f5eff4085","msg":"ScriptEngine: Executing script"}
{"level":20,"time":1768342013261,"env":"test","success":false,"durationMs":118,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342013315,"env":"test","hookId":"e7461c19-6f14-46df-910f-75311f13f7ef","hookName":"Python Data Processing","error":"PythonProcessError: Python was not found; run without arguments to install from the Microsoft Store, or disable this shortcut from Settings > Apps > Advanced app settings > App execution aliases.","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342013366,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342013366,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342013418,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342013418,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342013465,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342013465,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342013562,"env":"test","hookId":"9bcb7da9-e43f-4100-8b8d-efbaa4383fb2","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"beforeFinalBlock","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342013662,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"9b54ee14-de9a-435b-bbac-5ec195b31e15","phase":"beforeFinalBlock","hookCount":1,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342013662,"env":"test","language":"javascript","inputKeys":["user_name"],"phase":"beforeFinalBlock","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"9b54ee14-de9a-435b-bbac-5ec195b31e15","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342013663,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342013665,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342013714,"env":"test","hookId":"9bcb7da9-e43f-4100-8b8d-efbaa4383fb2","hookName":"Prepare Document Data","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342013765,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342013765,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342013812,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342013812,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342013864,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342013864,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342013964,"env":"test","hookId":"798be06f-9070-470f-9083-61c4b75d2b52","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"afterDocumentsGenerated","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342014067,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"388b46d7-b351-4313-ad53-64d504c5d570","phase":"afterDocumentsGenerated","hookCount":1,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342014067,"env":"test","language":"javascript","inputKeys":[],"phase":"afterDocumentsGenerated","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"388b46d7-b351-4313-ad53-64d504c5d570","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342014068,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342014069,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342014116,"env":"test","hookId":"798be06f-9070-470f-9083-61c4b75d2b52","hookName":"Post-Generation Cleanup","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342014170,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342014170,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342014219,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342014219,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342014270,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342014270,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342014370,"env":"test","hookId":"12145b1b-18b5-4173-bdfa-9263fd17b636","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"beforePage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342014470,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"34b3ca15-2958-40ca-8328-da5d0eacc8b6","phase":"beforePage","sectionId":"48ec4b86-b147-4f6e-9caa-6b50ca2a7c4b","hookCount":4,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342014470,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"34b3ca15-2958-40ca-8328-da5d0eacc8b6","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342014470,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342014472,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342014522,"env":"test","hookId":"051b4dad-67ae-4e4a-9334-e751bf79d130","hookName":"Log Page Entry","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342014523,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"34b3ca15-2958-40ca-8328-da5d0eacc8b6","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342014523,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342014524,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342014576,"env":"test","hookId":"b60cfa79-1f91-4ec1-89fd-60219745624a","hookName":"Prefill Data","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342014576,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"34b3ca15-2958-40ca-8328-da5d0eacc8b6","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342014577,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342014578,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342014626,"env":"test","hookId":"bae36024-6e52-42be-83af-0726dd2193fd","hookName":"Error Hook","error":"SandboxError: Intentional test error","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342014626,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"34b3ca15-2958-40ca-8328-da5d0eacc8b6","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342014626,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342014728,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342014777,"env":"test","hookId":"12145b1b-18b5-4173-bdfa-9263fd17b636","hookName":"Timeout Test","error":"TimeoutError: Execution exceeded time limit","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342014833,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342014834,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342014886,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342014886,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342014934,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342014934,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342015032,"env":"test","hookId":"25cbc845-c856-4741-ac6d-5da9ad6fa3ab","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"beforePage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342015082,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342015082,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342015134,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342015134,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342015181,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342015181,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342015281,"env":"test","hookId":"98b60bc3-8c76-4595-a30e-cbe60a712077","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"beforePage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342015331,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342015331,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342015378,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342015378,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342015428,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342015428,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342015528,"env":"test","hookId":"122cdce3-e8b0-4ef4-93c9-45beea0f5ca2","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"beforePage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342015632,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"6736ee14-e21c-4469-8b88-f269c5c8920a","phase":"beforePage","sectionId":"48ec4b86-b147-4f6e-9caa-6b50ca2a7c4b","hookCount":7,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342015632,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"6736ee14-e21c-4469-8b88-f269c5c8920a","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342015633,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342015634,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342015684,"env":"test","hookId":"051b4dad-67ae-4e4a-9334-e751bf79d130","hookName":"Log Page Entry","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342015684,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"6736ee14-e21c-4469-8b88-f269c5c8920a","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342015684,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342015686,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342015736,"env":"test","hookId":"b60cfa79-1f91-4ec1-89fd-60219745624a","hookName":"Prefill Data","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342015737,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"6736ee14-e21c-4469-8b88-f269c5c8920a","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342015737,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342015738,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342015789,"env":"test","hookId":"bae36024-6e52-42be-83af-0726dd2193fd","hookName":"Error Hook","error":"SandboxError: Intentional test error","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342015789,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"6736ee14-e21c-4469-8b88-f269c5c8920a","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342015790,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342015891,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342015939,"env":"test","hookId":"12145b1b-18b5-4173-bdfa-9263fd17b636","hookName":"Timeout Test","error":"TimeoutError: Execution exceeded time limit","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342015939,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"6736ee14-e21c-4469-8b88-f269c5c8920a","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342015940,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342015941,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342015990,"env":"test","hookId":"25cbc845-c856-4741-ac6d-5da9ad6fa3ab","hookName":"First Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342015990,"env":"test","language":"javascript","inputKeys":["step"],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"6736ee14-e21c-4469-8b88-f269c5c8920a","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342015990,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342015992,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342016042,"env":"test","hookId":"98b60bc3-8c76-4595-a30e-cbe60a712077","hookName":"Second Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342016042,"env":"test","language":"javascript","inputKeys":["step"],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"6736ee14-e21c-4469-8b88-f269c5c8920a","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342016042,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342016044,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342016091,"env":"test","hookId":"122cdce3-e8b0-4ef4-93c9-45beea0f5ca2","hookName":"Third Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342016143,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342016143,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342016190,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342016190,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342016237,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342016237,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342016393,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342016393,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342016445,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342016445,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342016492,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342016492,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342016648,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342016648,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342016699,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342016699,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342016858,"env":"test","hookId":"051b4dad-67ae-4e4a-9334-e751bf79d130","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","msg":"LifecycleHookService: Updated lifecycle hook"}
{"level":20,"time":1768342016918,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342016918,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342016966,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342016966,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342017019,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342017019,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342017122,"env":"test","hookId":"6cf6ae07-70fd-4693-aabb-c62249ff0391","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"beforePage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342017177,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342017177,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342017239,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342017239,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342017383,"env":"test","hookId":"6cf6ae07-70fd-4693-aabb-c62249ff0391","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","msg":"LifecycleHookService: Deleted lifecycle hook"}
{"level":20,"time":1768342017488,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342017489,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342017545,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342017545,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342017593,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342017593,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342017690,"env":"test","hookId":"83371cf2-18f5-42e3-963b-581b4493e457","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","phase":"beforePage","msg":"LifecycleHookService: Created lifecycle hook"}
{"level":20,"time":1768342017742,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342017742,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342017793,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342017793,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342017889,"env":"test","language":"javascript","inputKeys":["number"],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"test-run","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342017889,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342017891,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":20,"time":1768342017994,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"a705686b-866f-42a4-9c8b-91d8c2b16a25","phase":"beforePage","sectionId":"48ec4b86-b147-4f6e-9caa-6b50ca2a7c4b","hookCount":7,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342017994,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"a705686b-866f-42a4-9c8b-91d8c2b16a25","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342017994,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342017995,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342018047,"env":"test","hookId":"25cbc845-c856-4741-ac6d-5da9ad6fa3ab","hookName":"First Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342018047,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"a705686b-866f-42a4-9c8b-91d8c2b16a25","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342018048,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342018049,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342018100,"env":"test","hookId":"bae36024-6e52-42be-83af-0726dd2193fd","hookName":"Error Hook","error":"SandboxError: Intentional test error","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342018100,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"a705686b-866f-42a4-9c8b-91d8c2b16a25","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342018101,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342018201,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342018248,"env":"test","hookId":"12145b1b-18b5-4173-bdfa-9263fd17b636","hookName":"Timeout Test","error":"TimeoutError: Execution exceeded time limit","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342018248,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"a705686b-866f-42a4-9c8b-91d8c2b16a25","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342018249,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342018250,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342018297,"env":"test","hookId":"b60cfa79-1f91-4ec1-89fd-60219745624a","hookName":"Prefill Data","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342018297,"env":"test","language":"javascript","inputKeys":["number"],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"a705686b-866f-42a4-9c8b-91d8c2b16a25","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342018297,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342018299,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342018351,"env":"test","hookId":"83371cf2-18f5-42e3-963b-581b4493e457","hookName":"Test Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342018351,"env":"test","language":"javascript","inputKeys":["step"],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"a705686b-866f-42a4-9c8b-91d8c2b16a25","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342018351,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342018352,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342018401,"env":"test","hookId":"98b60bc3-8c76-4595-a30e-cbe60a712077","hookName":"Second Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342018401,"env":"test","language":"javascript","inputKeys":["step"],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"a705686b-866f-42a4-9c8b-91d8c2b16a25","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342018401,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342018403,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342018452,"env":"test","hookId":"122cdce3-e8b0-4ef4-93c9-45beea0f5ca2","hookName":"Third Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342018502,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342018502,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342018548,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342018549,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342018704,"env":"test","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"c909d072-d754-40e0-a9bf-08b9e987d297","phase":"beforePage","sectionId":"48ec4b86-b147-4f6e-9caa-6b50ca2a7c4b","hookCount":7,"msg":"LifecycleHookService: Executing hooks for phase"}
{"level":20,"time":1768342018705,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"c909d072-d754-40e0-a9bf-08b9e987d297","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342018705,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342018706,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342018758,"env":"test","hookId":"25cbc845-c856-4741-ac6d-5da9ad6fa3ab","hookName":"First Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342018758,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"c909d072-d754-40e0-a9bf-08b9e987d297","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342018758,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342018760,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342018810,"env":"test","hookId":"bae36024-6e52-42be-83af-0726dd2193fd","hookName":"Error Hook","error":"SandboxError: Intentional test error","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342018810,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"c909d072-d754-40e0-a9bf-08b9e987d297","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342018810,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342018911,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342018960,"env":"test","hookId":"12145b1b-18b5-4173-bdfa-9263fd17b636","hookName":"Timeout Test","error":"TimeoutError: Execution exceeded time limit","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342018960,"env":"test","language":"javascript","inputKeys":[],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"c909d072-d754-40e0-a9bf-08b9e987d297","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342018961,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342018962,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342019011,"env":"test","hookId":"b60cfa79-1f91-4ec1-89fd-60219745624a","hookName":"Prefill Data","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342019011,"env":"test","language":"javascript","inputKeys":["number"],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"c909d072-d754-40e0-a9bf-08b9e987d297","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342019011,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342019012,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342019064,"env":"test","hookId":"83371cf2-18f5-42e3-963b-581b4493e457","hookName":"Test Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342019064,"env":"test","language":"javascript","inputKeys":["step"],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"c909d072-d754-40e0-a9bf-08b9e987d297","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342019064,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342019066,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342019113,"env":"test","hookId":"98b60bc3-8c76-4595-a30e-cbe60a712077","hookName":"Second Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342019113,"env":"test","language":"javascript","inputKeys":["step"],"phase":"beforePage","workflowId":"cd26fc9a-0502-4263-b6e2-dc9ce92bbaee","runId":"c909d072-d754-40e0-a9bf-08b9e987d297","msg":"ScriptEngine: Executing script"}
{"level":40,"time":1768342019113,"env":"test","module":"enhanced-sandbox","error":{"code":"MODULE_NOT_FOUND","requireStack":["C:\\Users\\scoot\\poll\\VaultLogic\\node_modules\\isolated-vm\\isolated-vm.js"]},"msg":"isolated-vm not found, falling back to node 'vm' module"}
{"level":20,"time":1768342019114,"env":"test","success":false,"hasOutput":false,"msg":"ScriptEngine: Execution complete"}
{"level":40,"time":1768342019171,"env":"test","hookId":"122cdce3-e8b0-4ef4-93c9-45beea0f5ca2","hookName":"Third Hook","error":"SandboxError: emit is not defined","msg":"LifecycleHookService: Hook execution failed"}
{"level":20,"time":1768342019222,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342019222,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":20,"time":1768342019270,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","tenantId":"90bef56a-8bd4-4880-8259-951f4c498fce","msg":"Hydrated tenantId from DB"}
{"level":20,"time":1768342019270,"env":"test","module":"auth-middleware","userId":"6a1674f1-c5b3-4d07-914b-ac75a76d6387","msg":"Authenticated via JWT Strategy"}
{"level":30,"time":1768342019641,"env":"test","msg":"DB: closing pool..."}
[90mstdout[2m | tests/integration/lifecycle-hooks-execution.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":30,"time":1768342019642,"env":"test","msg":"DB: pool closed."}
 [31mÎ“Â¥Â»[39m tests/integration/lifecycle-hooks-execution.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m10 failed[39m[2m)[22m[33m 10817[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should execute beforePage hook and capture console output[39m[33m 431[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should execute beforePage hook with mutation mode enabled[39m[33m 467[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should handle errors gracefully without breaking workflow[39m[33m 511[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should execute afterPage hook with user input data[39m[33m 458[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should execute Python afterPage hook[39m[33m 575[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should execute beforeFinalBlock hook before document generation[39m[33m 398[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should execute afterDocumentsGenerated hook for cleanup[39m[33m 403[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should timeout hook that exceeds timeoutMs limit[39m[33m 661[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should execute multiple hooks in correct order[39m[33m 1314[2mms[22m[39m
       [32mÎ“Â£Ã´[39m should list all hooks for a workflow[32m 246[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should update a hook [33m 521[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should delete a hook [33m 574[2mms[22m[39m
[31m       [31mâ”œÃ¹[31m should test a hook with sample data[39m[33m 460[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should retrieve execution logs for a run [33m 708[2mms[22m[39m
       [33m[2mÎ“Â£Ã´[22m[39m should clear execution logs for a run [33m 768[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 13 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL  tests/integration/api.ai.personalization.test.ts > Personalization API Integration Tests > POST /api/ai/personalize/block > should rewrite text based on user settings
AssertionError: expected 500 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 500

 Î“Â¥Â» tests/integration/api.ai.personalization.test.ts:113:37
    111|                 });
    112| 
    113|             expect(response.status).toBe(200);
       |                                     ^
    114|             expect(response.body.text).toBe("Texto reescrito");
    115|             expect(mockGenerateContent).toHaveBeenCalled();

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/13]Î“Ã„Â»

 FAIL  tests/integration/api.ai.personalization.test.ts > Personalization API Integration Tests > POST /api/ai/personalize/help > should generate help text
AssertionError: expected 500 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 500

 Î“Â¥Â» tests/integration/api.ai.personalization.test.ts:133:37
    131|                 .send({ text: "Question?" });
    132| 
    133|             expect(response.status).toBe(200);
       |                                     ^
    134|             expect(response.body.text).toBe("Helpful text");
    135|         });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/13]Î“Ã„Â»

 FAIL  tests/integration/api.ai.personalization.test.ts > Personalization API Integration Tests > POST /api/ai/personalize/settings > should update user settings
AssertionError: expected 500 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 500

 Î“Â¥Â» tests/integration/api.ai.personalization.test.ts:144:37
    142|                 .send({ tone: 'formal' });
    143| 
    144|             expect(response.status).toBe(200);
       |                                     ^
    145| 
    146|             // Verify in DB

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/13]Î“Ã„Â»

 FAIL  tests/integration/lifecycle-hooks-execution.test.ts > Lifecycle Hooks Execution > Phase: beforePage > should execute beforePage hook and capture console output
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 Î“Â¥Â» tests/integration/lifecycle-hooks-execution.test.ts:126:30
    124|       });
    125| 
    126|       expect(result.success).toBe(true);
       |                              ^
    127|       expect(result.errors).toBeUndefined();
    128|       expect(result.consoleOutput).toBeDefined();

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/13]Î“Ã„Â»

 FAIL  tests/integration/lifecycle-hooks-execution.test.ts > Lifecycle Hooks Execution > Phase: beforePage > should execute beforePage hook with mutation mode enabled
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 Î“Â¥Â» tests/integration/lifecycle-hooks-execution.test.ts:188:30
    186|       });
    187| 
    188|       expect(result.success).toBe(true);
       |                              ^
    189|       // Verify mutation applied
    190|       expect(result.data).toHaveProperty('pageLoadTime');

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/13]Î“Ã„Â»

 FAIL  tests/integration/lifecycle-hooks-execution.test.ts > Lifecycle Hooks Execution > Phase: beforePage > should handle errors gracefully without breaking workflow
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 Î“Â¥Â» tests/integration/lifecycle-hooks-execution.test.ts:232:30
    230| 
    231|       // Workflow continues despite error
    232|       expect(result.success).toBe(true);
       |                              ^
    233|       expect(result.errors).toBeDefined();
    234|       expect(result.errors!.length).toBeGreaterThan(0);

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/13]Î“Ã„Â»

 FAIL  tests/integration/lifecycle-hooks-execution.test.ts > Lifecycle Hooks Execution > Phase: afterPage > should execute afterPage hook with user input data
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 Î“Â¥Â» tests/integration/lifecycle-hooks-execution.test.ts:303:30
    301|       });
    302| 
    303|       expect(result.success).toBe(true);
       |                              ^
    304|       expect(result.data.validationPassed).toBe(true);
    305|       expect(result.data.normalizedName).toBe('JOHN DOE');

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/13]Î“Ã„Â»

 FAIL  tests/integration/lifecycle-hooks-execution.test.ts > Lifecycle Hooks Execution > Phase: afterPage > should execute Python afterPage hook
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 Î“Â¥Â» tests/integration/lifecycle-hooks-execution.test.ts:357:30
    355|       });
    356| 
    357|       expect(result.success).toBe(true);
       |                              ^
    358|       expect(result.data.wordCount).toBe(2);
    359|       expect(result.data.charCount).toBe(10);

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/13]Î“Ã„Â»

 FAIL  tests/integration/lifecycle-hooks-execution.test.ts > Lifecycle Hooks Execution > Phase: beforeFinalBlock > should execute beforeFinalBlock hook before document generation
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 Î“Â¥Â» tests/integration/lifecycle-hooks-execution.test.ts:410:30
    408|       });
    409| 
    410|       expect(result.success).toBe(true);
       |                              ^
    411|       expect(result.data.documentTitle).toBe('Alice wonderland');
    412|       expect(result.data.documentDate).toMatch(/[A-Z][a-z]+ \d{2}, \d{Î“Ã‡Âª

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[9/13]Î“Ã„Â»

 FAIL  tests/integration/lifecycle-hooks-execution.test.ts > Lifecycle Hooks Execution > Phase: afterDocumentsGenerated > should execute afterDocumentsGenerated hook for cleanup
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 Î“Â¥Â» tests/integration/lifecycle-hooks-execution.test.ts:463:30
    461|       });
    462| 
    463|       expect(result.success).toBe(true);
       |                              ^
    464|       expect(result.data.documentsGenerated).toBe(true);
    465|       expect(result.data.completedAt).toBeDefined();

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[10/13]Î“Ã„Â»

 FAIL  tests/integration/lifecycle-hooks-execution.test.ts > Lifecycle Hooks Execution > Timeout Enforcement > should timeout hook that exceeds timeoutMs limit
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 Î“Â¥Â» tests/integration/lifecycle-hooks-execution.test.ts:513:30
    511| 
    512|       // Workflow continues despite timeout
    513|       expect(result.success).toBe(true);
       |                              ^
    514|       expect(result.errors).toBeDefined();
    515|       expect(result.errors![0].error).toMatch(/timeout|timed out/i);

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[11/13]Î“Ã„Â»

 FAIL  tests/integration/lifecycle-hooks-execution.test.ts > Lifecycle Hooks Execution > Multiple Hooks Execution Order > should execute multiple hooks in correct order
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 Î“Â¥Â» tests/integration/lifecycle-hooks-execution.test.ts:605:30
    603|       });
    604| 
    605|       expect(result.success).toBe(true);
       |                              ^
    606|       expect(result.data.step).toBe(3); // Final value from hook 3
    607|       expect(result.data.final).toBe(true);

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[12/13]Î“Ã„Â»

 FAIL  tests/integration/lifecycle-hooks-execution.test.ts > Lifecycle Hooks Execution > Hook Management API > should test a hook with sample data
TypeError: Cannot read properties of undefined (reading 'doubled')
 Î“Â¥Â» tests/integration/lifecycle-hooks-execution.test.ts:717:39
    715|       expect(testRes.status).toBe(200);
    716|       expect(testRes.body.success).toBe(true);
    717|       expect(testRes.body.data.output.doubled).toBe(42);
       |                                       ^
    718|     });
    719|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[13/13]Î“Ã„Â»


[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (3)[39m
[2m      Tests [22m [1m[31m13 failed[39m[22m[2m | [22m[1m[32m15 passed[39m[22m[90m (28)[39m
[2m   Start at [22m 16:06:40
[2m   Duration [22m 26.22s[2m (transform 6.59s, setup 460ms, import 15.82s, tests 15.03s, environment 1.13s)[22m

