npm warn Unknown project config "puppeteer_skip_download". This will stop working in the next major version of npm.

[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90mC:/Users/scoot/poll/VaultLogic[39m

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mSETUP: Loading setup.ts...
[dotenv@17.2.3] injecting env (20) from .env -- tip: Î“Â£Ã  audit secrets and track compliance: https://dotenvx.com/ops

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m[dotenv@17.2.3] injecting env (0) from .env -- tip: Î“ÃœÃ–âˆ©â••Ã…  write to custom object with { processEnv: myObject }
DB: Skipping auto-init because NODE_ENV=test

{"level":30,"time":1768454146873,"env":"test","msg":"DB: initializing... Local"}
{"level":30,"time":1768454146895,"env":"test","msg":"DB: initialized flag set."}
[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“Â£Ã  Database initialized. Current schema: public
â‰¡Æ’Ã¶Ã¤ Running test migrations (manual file mode due to broken journal)...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0000_daffy_roughhouse.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0000_daffy_roughhouse.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0001_remove_participants.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0001_remove_participants.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0002_add_mode_columns.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0002_add_mode_columns.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0003_add_step_aliases.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0003_add_step_aliases.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0004_add_teams_and_acls.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0004_add_teams_and_acls.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0005_add_transform_block_phases.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0005_add_transform_block_phases.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0006_add_updated_at_columns.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0007_add_js_question_type.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0007_lying_namor.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0007_lying_namor.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0008_add_virtual_steps_for_transform_blocks.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0009_add_multi_tenant_data_model.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0009_real_vapor.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0009_real_vapor.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0010_add_external_connections_and_secret_types.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0010_add_external_connections_and_secret_types.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0010_nullable_creator_owner.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0011_add_trace_and_error_to_runs.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0012_add_analytics_sli_tables.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0012_add_analytics_sli_tables.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0013_add_intake_portal_columns.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0014_add_workflow_versioning_columns.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0015_add_intake_config.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0016_add_review_and_esign_tables.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0017_add_connections_table.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0018_add_branding_and_domains.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0019_add_collections_datastore.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0020_add_collection_block_types.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0021_add_page_conditions.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0021_add_page_conditions.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0022_add_question_conditions.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0022_add_question_conditions.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0023_add_repeater_type.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0024_add_document_engine_tables.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0024_add_document_engine_tables.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0024_add_performance_indexes.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0025_fix_workflows_missing_columns.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0026_fix_schema_inconsistencies.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0027_fix_metrics_rollups_unique_index.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0028_fix_workflow_status_enum.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0029_add_datavault_tables.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0029_add_datavault_tables.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0030_add_auto_number_column_type.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0031_fix_survey_status_enum.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0032_add_primary_key_and_unique_columns.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0032_add_primary_key_and_unique_columns.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0033_add_datavault_databases.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0033_add_datavault_databases.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0034_add_reference_columns.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0035_add_datavault_sequences.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0036_add_column_descriptions.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0036_add_reference_cascade_policy.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0037_add_column_width.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0038_add_row_archiving.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0039_add_select_multiselect_columns.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0040_add_autonumber_enhancements.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0040_add_autonumber_enhancements.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0041_add_datavault_row_notes.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0042_add_datavault_api_tokens.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0042_add_datavault_api_tokens.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0043_add_datavault_table_permissions.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0043_add_datavault_table_permissions.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0044_add_step_default_values.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0045_sync_project_created_by.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0046_add_final_documents_step_type.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0046_fix_workflow_runs_section_constraint.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0047_add_run_generated_documents_table.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0048_fix_autonumber_function.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0048_sync_project_tenant_from_creator.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0049_add_format_to_autonumber.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0049_add_sections_config_column.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0050_add_workflow_snapshots.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0050_add_workflow_snapshots.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0051_add_new_block_types.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0051_add_snapshot_version_hash.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0051_add_snapshot_version_hash.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0052_add_scripting_system.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0052_add_scripting_system.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0053_upgrade_data_sources.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0054_create_workflow_queries.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0055_add_query_block_support.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0055_add_query_block_support.sql, retrying statement-by-statement...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0056_add_datavault_block_types.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0057_add_step_values_composite_index.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0058_add_logic_rules_indexes.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0059_add_performance_indexes.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39m   Applying 0060_flashy_jimmy_woo.sql...

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mÎ“ÃœÃ¡âˆ©â••Ã… Partial failure in 0060_flashy_jimmy_woo.sql, retrying statement-by-statement...

stderr | tests/integration/ai/workflowEdit.test.ts
Î“Â¥Ã® FAILED MIGRATION 0060_flashy_jimmy_woo.sql STATEMENT: insert or update on table "organizations" violates foreign key constraint "organizations_tenant_id_tenants_id_fk"
Î“ÃœÃ¡âˆ©â••Ã… Migrations failed (non-fatal if DB exists): error: insert or update on table "organizations" violates foreign key constraint "organizations_tenant_id_tenants_id_fk"
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at C:/Users/scoot/poll/VaultLogic/tests/setup.ts:193:25 {
  length: 335,
  severity: 'ERROR',
  code: '23503',
  detail: 'Key (tenant_id)=(53cebec7-208e-4171-af2d-89f41af969f6) is not present in table "tenants".',
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: 'public',
  table: 'organizations',
  column: undefined,
  dataType: undefined,
  constraint: 'organizations_tenant_id_tenants_id_fk',
  file: 'ri_triggers.c',
  line: '2599',
  routine: 'ri_ReportViolation'
}

[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mDEBUG: Existing functions: [
  {
    "proname": "datavault_get_next_autonumber",
    "proargnames": [
      "p_tenant_id",
      "p_table_id",
      "p_column_id",
      "p_prefix",
      "p_padding",
      "p_reset_policy"
    ],
    "proargtypes": "2950 2950 2950 25 23 25",
    "signature": "datavault_get_next_autonumber(uuid,uuid,uuid,text,integer,text)"
  },
  {
    "proname": "datavault_get_next_autonumber",
    "proargnames": [
      "p_tenant_id",
      "p_table_id",
      "p_column_id",
      "p_prefix",
      "p_padding",
      "p_reset_policy",
      "p_format"
    ],
    "proargtypes": "2950 2950 2950 25 23 25 25",
    "signature": "datavault_get_next_autonumber(uuid,uuid,uuid,text,integer,text,text)"
  }
]

{"level":30,"time":1768454373403,"env":"test","workflowId":"40bfbfaf-6593-4e8a-af6b-55eea6904a76","userId":"9296cb8c-04de-46e9-ace6-69987df77939","sectionsCount":0,"stepsCount":0,"logicRulesCount":0,"msg":"getWorkflowWithDetails called"}
{"level":50,"time":1768454373505,"env":"test","module":"ai-workflow-edit-routes","error":{"length":178,"name":"error","severity":"ERROR","code":"42703","hint":"Perhaps you meant to reference the column \"aiSettings.updated_at\".","position":"54","file":"parse_relation.c","line":"3723","routine":"errorMissingColumn"},"workflowId":"40bfbfaf-6593-4e8a-af6b-55eea6904a76","msg":"AI model call failed"}
stderr | tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should create draft version on successful AI edit
DEBUG: INNER CATCH AI ERROR: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40 {
  length: 178,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: 'Perhaps you meant to reference the column "aiSettings.updated_at".',
  position: '54',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3723',
  routine: 'errorMissingColumn'
}
Stack: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40

{"level":30,"time":1768454374056,"env":"test","workflowId":"c2f7cf33-a135-42c8-914d-1707c9dc5769","userId":"9296cb8c-04de-46e9-ace6-69987df77939","sectionsCount":0,"stepsCount":0,"logicRulesCount":0,"msg":"getWorkflowWithDetails called"}
{"level":50,"time":1768454374158,"env":"test","module":"ai-workflow-edit-routes","error":{"length":178,"name":"error","severity":"ERROR","code":"42703","hint":"Perhaps you meant to reference the column \"aiSettings.updated_at\".","position":"54","file":"parse_relation.c","line":"3723","routine":"errorMissingColumn"},"workflowId":"c2f7cf33-a135-42c8-914d-1707c9dc5769","msg":"AI model call failed"}
stderr | tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should enforce draft mode (revert active workflow to draft)
DEBUG: INNER CATCH AI ERROR: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40 {
  length: 178,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: 'Perhaps you meant to reference the column "aiSettings.updated_at".',
  position: '54',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3723',
  routine: 'errorMissingColumn'
}
Stack: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40

{"level":30,"time":1768454374639,"env":"test","workflowId":"4ebe86ba-f3db-42e2-ab94-cfac3875bdf6","userId":"9296cb8c-04de-46e9-ace6-69987df77939","sectionsCount":0,"stepsCount":0,"logicRulesCount":0,"msg":"getWorkflowWithDetails called"}
{"level":50,"time":1768454374742,"env":"test","module":"ai-workflow-edit-routes","error":{"length":178,"name":"error","severity":"ERROR","code":"42703","hint":"Perhaps you meant to reference the column \"aiSettings.updated_at\".","position":"54","file":"parse_relation.c","line":"3723","routine":"errorMissingColumn"},"workflowId":"4ebe86ba-f3db-42e2-ab94-cfac3875bdf6","msg":"AI model call failed"}
stderr | tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should not create version when no changes detected (checksum match)
DEBUG: INNER CATCH AI ERROR: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40 {
  length: 178,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: 'Perhaps you meant to reference the column "aiSettings.updated_at".',
  position: '54',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3723',
  routine: 'errorMissingColumn'
}
Stack: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40

{"level":30,"time":1768454375268,"env":"test","workflowId":"b040369f-e56e-4c9e-8b2e-58fa0bb9f0dd","userId":"9296cb8c-04de-46e9-ace6-69987df77939","sectionsCount":0,"stepsCount":0,"logicRulesCount":0,"msg":"getWorkflowWithDetails called"}
{"level":50,"time":1768454375367,"env":"test","module":"ai-workflow-edit-routes","error":{"length":178,"name":"error","severity":"ERROR","code":"42703","hint":"Perhaps you meant to reference the column \"aiSettings.updated_at\".","position":"54","file":"parse_relation.c","line":"3723","routine":"errorMissingColumn"},"workflowId":"b040369f-e56e-4c9e-8b2e-58fa0bb9f0dd","msg":"AI model call failed"}
stderr | tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should reject unsafe DataVault operations
DEBUG: INNER CATCH AI ERROR: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40 {
  length: 178,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: 'Perhaps you meant to reference the column "aiSettings.updated_at".',
  position: '54',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3723',
  routine: 'errorMissingColumn'
}
Stack: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40

{"level":30,"time":1768454375856,"env":"test","workflowId":"4f003633-74c4-4cfb-8937-6d9fdff9170e","userId":"9296cb8c-04de-46e9-ace6-69987df77939","sectionsCount":0,"stepsCount":0,"logicRulesCount":0,"msg":"getWorkflowWithDetails called"}
{"level":50,"time":1768454375959,"env":"test","module":"ai-workflow-edit-routes","error":{"length":178,"name":"error","severity":"ERROR","code":"42703","hint":"Perhaps you meant to reference the column \"aiSettings.updated_at\".","position":"54","file":"parse_relation.c","line":"3723","routine":"errorMissingColumn"},"workflowId":"4f003633-74c4-4cfb-8937-6d9fdff9170e","msg":"AI model call failed"}
stderr | tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should handle multi-operation edits with tempId resolution
DEBUG: INNER CATCH AI ERROR: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40 {
  length: 178,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: 'Perhaps you meant to reference the column "aiSettings.updated_at".',
  position: '54',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3723',
  routine: 'errorMissingColumn'
}
Stack: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40

{"level":30,"time":1768454376440,"env":"test","workflowId":"9c5a7644-f6df-4c0a-a590-9a99656e283e","userId":"9296cb8c-04de-46e9-ace6-69987df77939","sectionsCount":0,"stepsCount":0,"logicRulesCount":0,"msg":"getWorkflowWithDetails called"}
{"level":50,"time":1768454376542,"env":"test","module":"ai-workflow-edit-routes","error":{"length":178,"name":"error","severity":"ERROR","code":"42703","hint":"Perhaps you meant to reference the column \"aiSettings.updated_at\".","position":"54","file":"parse_relation.c","line":"3723","routine":"errorMissingColumn"},"workflowId":"9c5a7644-f6df-4c0a-a590-9a99656e283e","msg":"AI model call failed"}
stderr | tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should create BEFORE and AFTER snapshots
DEBUG: INNER CATCH AI ERROR: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40 {
  length: 178,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: 'Perhaps you meant to reference the column "aiSettings.updated_at".',
  position: '54',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3723',
  routine: 'errorMissingColumn'
}
Stack: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40

{"level":30,"time":1768454377167,"env":"test","workflowId":"b481981a-f199-45d3-bd18-9603eb26dc71","userId":"9296cb8c-04de-46e9-ace6-69987df77939","sectionsCount":1,"stepsCount":1,"logicRulesCount":0,"msg":"getWorkflowWithDetails called"}
{"level":50,"time":1768454377267,"env":"test","module":"ai-workflow-edit-routes","error":{"length":178,"name":"error","severity":"ERROR","code":"42703","hint":"Perhaps you meant to reference the column \"aiSettings.updated_at\".","position":"54","file":"parse_relation.c","line":"3723","routine":"errorMissingColumn"},"workflowId":"b481981a-f199-45d3-bd18-9603eb26dc71","msg":"AI model call failed"}
stderr | tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should rollback on validation failure
DEBUG: INNER CATCH AI ERROR: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40 {
  length: 178,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: 'Perhaps you meant to reference the column "aiSettings.updated_at".',
  position: '54',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3723',
  routine: 'errorMissingColumn'
}
Stack: error: column "created_at" does not exist
    at C:\Users\scoot\poll\VaultLogic\node_modules\pg-pool\index.js:45:11
    at processTicksAndRejections (node:internal/process/task_queues:103:5)
    at file:///C:/Users/scoot/poll/VaultLogic/node_modules/drizzle-orm/node-postgres/session.js:83:22
    at AiSettingsService.getEffectivePrompt (C:/Users/scoot/poll/VaultLogic/server/services/AiSettingsService.ts:39:32)
    at C:/Users/scoot/poll/VaultLogic/server/routes/ai/workflowEdit.routes.ts:71:40

{"level":30,"time":1768454377269,"env":"test","msg":"DB: closing pool..."}
[90mstdout[2m | tests/integration/ai/workflowEdit.test.ts
[22m[39mâ‰¡Æ’Âºâ•£ Cleaning up test environment...

{"level":30,"time":1768454377270,"env":"test","msg":"DB: pool closed."}
 [31mÎ“Â¥Â»[39m tests/integration/ai/workflowEdit.test.ts [2m([22m[2m8 tests[22m[2m | [22m[31m7 failed[39m[2m)[22m[33m 230397[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m should create draft version on successful AI edit[39m[33m 612[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m should enforce draft mode (revert active workflow to draft)[39m[33m 647[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m should not create version when no changes detected (checksum match)[39m[33m 583[2mms[22m[39m
     [32mÎ“Â£Ã´[39m should reject unauthorized access[32m 57[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m should reject unsafe DataVault operations[39m[33m 569[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m should handle multi-operation edits with tempId resolution[39m[33m 592[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m should create BEFORE and AFTER snapshots[39m[33m 582[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m should rollback on validation failure[39m[33m 726[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Suites 1 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL  tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test
TypeError: Cannot read properties of undefined (reading 'actorId')
 Î“Â¥Â» tests/integration/ai/workflowEdit.test.ts:149:55
    147|     // Steps are deleted via cascade when sections are deleted
    148|     // Delete audit events first to avoid FK constraint violations
    149|     await db.delete(auditEvents).where(eq(auditEvents.actorId, testUseÎ“Ã‡Âª
       |                                                       ^
    150|     await db.delete(sections).where(eq(sections.workflowId, testWorkflÎ“Ã‡Âª
    151|     await db.delete(workflowVersions).where(eq(workflowVersions.workflÎ“Ã‡Âª

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/8]Î“Ã„Â»


Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 7 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL  tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should create draft version on successful AI edit
Error: expected 200 "OK", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/ai/workflowEdit.test.ts:170:8
    168|         },
    169|       })
    170|       .expect(200);
       |        ^
    171| 
    172|     expect(response.body.success).toBe(true);
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/8]Î“Ã„Â»

 FAIL  tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should enforce draft mode (revert active workflow to draft)
Error: expected 200 "OK", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/ai/workflowEdit.test.ts:210:8
    208|         userMessage: 'Add a phone number field',
    209|       })
    210|       .expect(200);
       |        ^
    211| 
    212|     // Verify workflow is now draft
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/8]Î“Ã„Â»

 FAIL  tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should not create version when no changes detected (checksum match)
Error: expected 200 "OK", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/ai/workflowEdit.test.ts:227:8
    225|         userMessage: 'Add contact section',
    226|       })
    227|       .expect(200);
       |        ^
    228| 
    229|     const versionId1 = response1.body.data.versionId;
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/8]Î“Ã„Â»

 FAIL  tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should reject unsafe DataVault operations
Error: expected 400 "Bad Request", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/ai/workflowEdit.test.ts:310:8
    308|         userMessage: 'Delete all data',
    309|       })
    310|       .expect(400);
       |        ^
    311| 
    312|     expect(response.body.success).toBe(false);
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/8]Î“Ã„Â»

 FAIL  tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should handle multi-operation edits with tempId resolution
Error: expected 200 "OK", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/ai/workflowEdit.test.ts:381:8
    379|         userMessage: 'Add emergency contact section with name and phonÎ“Ã‡Âª
    380|       })
    381|       .expect(200);
       |        ^
    382| 
    383|     expect(response.body.success).toBe(true);
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/8]Î“Ã„Â»

 FAIL  tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should create BEFORE and AFTER snapshots
Error: expected 200 "OK", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/ai/workflowEdit.test.ts:418:8
    416|         userMessage: 'Add a simple field',
    417|       })
    418|       .expect(200);
       |        ^
    419| 
    420|     const versionId = response.body.data.versionId;
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/8]Î“Ã„Â»

 FAIL  tests/integration/ai/workflowEdit.test.ts > POST /api/workflows/:workflowId/ai/edit - Integration Test > should rollback on validation failure
Error: expected 400 "Bad Request", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/ai/workflowEdit.test.ts:487:8
    485|         userMessage: 'Add backup email field',
    486|       })
    487|       .expect(400);
       |        ^
    488| 
    489|     expect(response.body.success).toBe(false);
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/8]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m7 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (8)[39m
[2m   Start at [22m 23:15:45
[2m   Duration [22m 232.07s[2m (transform 646ms, setup 140ms, import 1.17s, tests 230.40s, environment 0ms)[22m

